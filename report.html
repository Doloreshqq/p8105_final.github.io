<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Qin Huang (2284), Shaolei Ma (sm5592), Huanyu Chen (hc3451), Ou Sha (os2424), Lehan Zou (lz2950)" />


<title>Depression Factors Prediction based on DASS Responses Report</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="introduction.html">Introduction</a>
</li>
<li>
  <a href="data.html">Data</a>
</li>
<li>
  <a href="eda.html">Exploratory Data Analysis</a>
</li>
<li>
  <a href="logit_models.html">Statistical Analysis</a>
</li>
<li>
  <a href="https://doloreshqq.shinyapps.io/r_shiny_for_p8105/">Shiny App</a>
</li>
<li>
  <a href="report.html">Report</a>
</li>
<li>
  <a href="mailto:&lt;qh2284@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/Doloreshqq/p8105_final.github.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a>
    <span class="fa fa-brands fa-youtube"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Depression Factors Prediction based on DASS
Responses Report</h1>
<h4 class="author">Qin Huang (2284), Shaolei Ma (sm5592), Huanyu Chen
(hc3451), Ou Sha (os2424), Lehan Zou (lz2950)</h4>

</div>


<div id="motivation" class="section level2">
<h2><em>Motivation</em></h2>
<p>Observing that mental health issues appear at a younger and younger
age, we would like to test if DASS can potentially provide a means to
objectively evaluate the severity and the potential factors of
depression among different population including races, ages, etc.</p>
</div>
<div id="related-work" class="section level2">
<h2><em>Related Work</em></h2>
<p>In the realm of depression level research, the exploration of
psychosocial determinants has been a prominent focus. <a
href="doi:%2010.1016/j.chiabu.2017.03.016">Melissa et. al</a> delved
into the impact of adverse childhood experiences on the prevalence of
depression in adulthood, elucidating the long-term consequences of
early-life stressors. Concurrently, the work of <a
href="doi:%2010.1016/j.wombi.2020.12.014">Virginia et. al</a> the
relationship between perceived social support and anxiety/depression in
UK-based pregnant women during the COVID-19 pandemic. Furthermore, a
meta-analysis by <a href="https://doi.org/10.1002/ejsp.2508">Postmes et.
al</a> has systematically review and quantitatively analyze existing
studies to examine the relationship between social identification and
depression. Such interdisciplinary approaches contribute to a more
comprehensive and nuanced comprehension of the factors influencing
mental health and provide a foundation for tailored interventions and
support mechanisms.</p>
</div>
<div id="initial-questions" class="section level2">
<h2><em>Initial Questions</em></h2>
<ul>
<li><p>What factors have a significant impact on the level of
depression?</p></li>
<li><p>Do different countries exhibit significantly varied rates of
depression at different levels of development?</p></li>
<li><p>What factors account for the differences in the development of
depression levels?</p></li>
<li><p>What factors can be used to predict depression levels?</p></li>
</ul>
</div>
<div id="introduction" class="section level2">
<h2><em>Introduction</em></h2>
<p>Depression, a pervasive mental health challenge, is becoming
increasingly prevalent among younger demographics, necessitating a
deeper understanding of its existence in diverse populations. This study
seeks to harness the potential of the Depression, Anxiety, and Stress
Scales (DASS) as a comprehensive tool to objectively assess the severity
and underlying factors influencing or contributing to depression across
demographic groups, including differences in race, age groups, and
more.</p>
<p>Our study utilizes an extensive dataset from the Depression, Anxiety,
and Stress Scales (DASS) Responses accessible via Kaggle, to accomplish
our objectives. This dataset includes 42 self-reported items, carefully
created to evaluate emotional states associated with depression,
anxiety, and stress. The objective of our project is to contribute to a
more thorough comprehension of the determinants of depression, which
could potentially inform customized support strategies and targeted
interventions designed for specific population groups.</p>
<p>Our methodology involves filtering data, performing validity checks,
and eliminating unreliable data to bolster the integrity of our
analysis. We will then stratify individuals’ depression levels and
present their distributions across various variables using graphical
representations, such as line charts. To compare factor distributions
across different depression levels, we will employ statistical tools
like the chi-squared test. Our study aims to employ logistic regression
models to identify influential factors contributing to varying levels of
depression, including age, gender, geographical location, and etc.
Additionally, we plan to create data visualizations on coefficients and
model fit after constructing the model.</p>
</div>
<div id="data" class="section level2">
<h2><em>Data</em></h2>
<div id="data-source" class="section level3">
<h3>Data Source</h3>
<p><strong>DASS-42 Responses</strong></p>
<p>Our group applied the dataset from Kaggle Depression, Anxiety, and
Stress Scales Responses (can be find <a
href="https://www.kaggle.com/datasets/lucasgreenwell/depression-anxiety-stress-scales-responses">here</a>)
for this project. The DASS-42 is a self-report scale consisting of 42
items intended to gauge emotional states related to depression, anxiety,
and stress. The primary benefit of utilizing the DASS in a clinical
context is its ability to ascertain the specific location of emotional
turmoil, contributing to a more comprehensive clinical assessment. Its
core function is to evaluate the severity of the fundamental symptoms
associated with depression, anxiety, and stress.</p>
<pre class="r"><code># Load the dataset
dass_raw = read.csv(&quot;./data/data.csv&quot;, sep = &quot;\t&quot;)</code></pre>
<p>The raw data contain 39775 observations and 172 variables, which
contains the information of the participants’ responses.</p>
</div>
<div id="data-establishment-and-data-cleaning" class="section level3">
<h3>Data Establishment and Data Cleaning</h3>
<p>As we mentioned before, the raw data contains the basic information
from the responses. Based on codebook.txt from Kaggle, we checked
whether the individual response is meaningful. The criteria are as
follow:</p>
<ul>
<li><p>The survey includes an accuracy check section, which provides
several word spelling questions to check whether participants had filled
out the questionnaire carefully.
<code>VCL6</code>,<code>VCL9</code>,<code>VCL12</code> represents words
that not exist. If the participants chose 1 in any of these three
questions, the response should be omit.</p></li>
<li><p>The raw data contains different missing values which needs to be
omitted. Specifically, <code>country</code> variable has “NONE” as the
missing value.</p></li>
<li><p><code>Age</code> variable have impossible values we need to clean
out. For example, 299 years for an age is not reasonable.</p></li>
</ul>
<pre class="r"><code># kick out meaningless observation
dass = dass_raw %&gt;%
  filter(!(VCL6 == 1 | VCL9 == 1 | VCL12 == 1)) %&gt;%
  filter(!country == &quot;NONE&quot;) %&gt;%
  filter(age &lt;= 100)

dass = dass %&gt;%
  dplyr::select(matches(&#39;Q\\d+A&#39;), country, education, urban, gender, age, religion, orientation, race, married) %&gt;%
  na.omit()</code></pre>
<p>Since we observed that there are some variables have actual meaning
corresponding to the original numeric value, we refactor these
variables, including <code>education</code>, <code>urban</code>,
<code>gender</code>, <code>religion</code>, <code>orientation</code>,
<code>race</code>, <code>married</code>. In these variables, if the
value is 0, it represents missing value and we delete these
observations.</p>
<pre class="r"><code># refactor the variables
dass_new = dass %&gt;%
  mutate(
    education = case_when(education == 1 ~ &#39;Less than high school&#39;, 
                               education == 2 ~ &#39;High school&#39;, 
                               education == 3 ~ &#39;University degree&#39;, 
                               education == 4 ~ &#39;Graduate degree&#39;),
    urban = case_when(urban == 1 ~ &#39;Rural&#39;,
                      urban == 2 ~ &#39;Suburban&#39;, 
                      urban == 3 ~ &#39;Urban&#39;),
    gender = case_when(gender == 1 ~ &#39;Male&#39;,
                       gender == 2 ~ &#39;Female&#39;,
                       gender == 3 ~ &#39;Other&#39;),
    religion = case_when(religion == 1 ~ &#39;Agnostic&#39;, 
                         religion == 2 ~ &#39;Atheist&#39;, 
                         religion == 3 ~ &#39;Buddhist&#39;, 
                         religion == 4 ~ &#39;Christian (Catholic)&#39;, 
                         religion == 5 ~ &#39;Christian (Mormon)&#39;, 
                         religion == 6 ~ &#39;Christian (Protestant)&#39;, 
                         religion == 7 ~ &#39;Christian (Other)&#39;, 
                         religion == 8 ~ &#39;Hindu&#39;, 
                         religion == 9 ~ &#39;Jewish&#39;, 
                         religion == 10 ~ &#39;Muslim&#39;, 
                         religion == 11 ~ &#39;Sikh&#39;, 
                         religion == 12 ~ &#39;Other&#39;),
    orientation = case_when(orientation == 1 ~ &#39;Heterosexual&#39;, 
                            orientation == 2 ~ &#39;Bisexual&#39;, 
                            orientation == 3 ~ &#39;Homosexual&#39;, 
                            orientation == 4 ~ &#39;Asexual&#39;, 
                            orientation == 5 ~ &#39;Other&#39;),
    race = case_when(race == 10 ~ &#39;Asian&#39;, 
                     race == 20 ~ &#39;Arab&#39;, 
                     race == 30 ~ &#39;Black&#39;, 
                     race == 40 ~ &#39;Indigenous Australian&#39;, 
                     race == 50 ~ &#39;Native American&#39;, 
                     race == 60 ~ &#39;White&#39;, 
                     race == 70 ~ &#39;Other&#39;),
    married = case_when(married == 1 ~ &#39;Never married&#39;, 
                        married == 2 ~ &#39;Currently married&#39;, 
                        married == 3 ~ &#39;Previously married&#39;)
    ) %&gt;%
  na.omit()</code></pre>
<p>Based on the scoring criteria (as shown in DASS-42-scoring.pdf), we
add up the values for Q3A, Q5A, Q10A, Q13A, Q16A, Q17A, Q21A, Q24A,
Q26A, Q31A, Q34A, Q37A, Q38A and Q42A as the depression scores.</p>
<p>Similarly, add up the values for Q2A, Q4A, Q7A, Q9A, Q15A, Q19A,
Q20A, Q23A, Q25A, Q28A, Q30A, Q36A, Q40A and Q41A as the anxiety scores
and the sum of Q1A, Q6A, Q8A, Q11A, Q12A, Q14A, Q18A, Q22A, Q27A, Q29A,
Q32A, Q33A, Q35A and Q39A as the stress scores.</p>
<p>Considering that the scoring criteria we refer to is 0-3 scale but
Kaggle dataset is 1-4 scale, we modify these three scores by minus
14.</p>
<p>After that, we could assign depression level, anxiety level and
stress level for each observation refer to the rule of:</p>
<ol style="list-style-type: decimal">
<li><p>Depression （score ~ level)</p>
<ul>
<li><p>0 - 9 ~ normal</p></li>
<li><p>10 - 13 ~ mild</p></li>
<li><p>14 - 20 ~ moderate</p></li>
<li><p>21 - 27 ~ severe</p></li>
<li><p>&gt;27 ~ extremely severe</p></li>
</ul></li>
<li><p>Anxiety</p>
<ul>
<li><p>0 - 7 ~ normal</p></li>
<li><p>8 - 9 ~ mild</p></li>
<li><p>10 - 14 ~ moderate</p></li>
<li><p>15 - 19 ~ severe</p></li>
<li><p>&gt;19 ~ extremely severe</p></li>
</ul></li>
<li><p>Stress</p>
<ul>
<li><p>0 - 14 ~ normal</p></li>
<li><p>15 - 18 ~ mild</p></li>
<li><p>19 - 25 ~ moderate</p></li>
<li><p>26 - 33 ~ severe</p></li>
<li><p>&gt;33 ~ extremely severe</p></li>
</ul></li>
</ol>
<p>Considering that stress, anxiety and depression might have
correlations, we apply correlation test for <code>stress_level</code>,
<code>depression_level</code>, <code>anxiety_level</code>.</p>
<pre class="r"><code>dass_heat2 &lt;- dass %&gt;%
  mutate(
    depression = Q3A + Q5A + Q10A + Q13A + Q16A + Q17A + Q21A + Q24A + Q26A + Q31A + Q34A + Q37A + Q38A + Q42A - 14,
    anxiety = Q2A + Q4A + Q7A + Q9A + Q15A + Q19A + Q20A + Q23A + Q25A + Q28A + Q30A + Q36A + Q40A + Q41A - 14,
    stress = Q1A + Q6A + Q8A + Q11A + Q12A + Q14A + Q18A + Q22A + Q27A + Q29A + Q32A + Q33A + Q35A + Q39A - 14
    ) %&gt;%
  mutate(depression = case_when(
    depression &gt;= 0 &amp; depression &lt;= 9 ~ 0,
    depression &gt;= 10 &amp; depression &lt;= 13 ~ 1,
    depression &gt;= 14 &amp; depression &lt;= 20 ~ 2,
    depression &gt;= 21 &amp; depression &lt;= 27 ~ 3,
    depression &gt;= 28 ~ 4
  )) %&gt;%
  mutate(anxiety = case_when(
    anxiety &gt;= 0 &amp; anxiety &lt;= 7 ~ 0,
    anxiety &gt;= 8 &amp; anxiety &lt;= 9 ~ 1,
    anxiety &gt;= 10 &amp; anxiety &lt;= 14 ~ 2,
    anxiety &gt;= 15 &amp; anxiety &lt;= 19 ~ 3,
    anxiety &gt;= 20 ~ 4
  )) %&gt;%
  mutate(stress = case_when(
    stress &gt;= 0 &amp; stress &lt;= 14 ~ 0,
    stress &gt;= 15 &amp; stress &lt;= 18 ~ 1,
    stress &gt;= 19 &amp; stress &lt;= 25 ~ 2,
    stress &gt;= 26 &amp; stress &lt;= 33 ~ 3,
    stress &gt;= 34 ~ 4
  )) %&gt;%
  dplyr::select(depression,anxiety,stress)

r1 &lt;- cor(dass_heat2,
         method = &quot;pearson&quot;,
         use = &quot;pairwise.complete.obs&quot;
) 

pheatmap(r1, 
         show_colnames = TRUE,   
         show_rownames=TRUE,    
         fontsize=5,             
         color = colorRampPalette(c(&#39;#ffffff&#39;,&#39;#ff0000&#39;))(100), 
         annotation_legend=TRUE, 
         border_color=NA,        
         scale=&quot;none&quot;,            
         cluster_rows = F,
         cluster_cols = F,
         breaks = seq(0, 1, length.out = 90)
)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>According to the heat map, we could conclude that these three
variables have strong correlation. Therefore, in our project, we take
depression_level as the representative.</p>
<p>Finally, we get our clean and tidy dataset for the project.</p>
<pre class="r"><code># create three different dataset
dass_new = dass_new %&gt;%
  mutate(
    depression = Q3A + Q5A + Q10A + Q13A + Q16A + Q17A + Q21A + Q24A + Q26A + Q31A + Q34A + Q37A + Q38A + Q42A - 14
    ) %&gt;%
  mutate(education = factor(education, levels = c(&#39;Less than high school&#39;, &#39;High school&#39;, &#39;University degree&#39;, &#39;Graduate degree&#39;))) %&gt;%
  mutate(married = factor(married, levels = c(&quot;Previously married&quot;, &quot;Currently married&quot;, &quot;Never married&quot;))) %&gt;%
  dplyr::select(-matches(&#39;Q\\d+A&#39;))

# create das level variables
dass_new = dass_new %&gt;%
  mutate(depression_level = case_when(
    depression &gt;= 0 &amp; depression &lt;= 9 ~ &#39;Normal&#39;,
    depression &gt;= 10 &amp; depression &lt;= 13 ~ &#39;Mild&#39;,
    depression &gt;= 14 &amp; depression &lt;= 20 ~ &#39;Moderate&#39;,
    depression &gt;= 21 &amp; depression &lt;= 27 ~ &#39;Severe&#39;,
    depression &gt;= 28 ~ &#39;Extremely severe&#39;
  )) %&gt;%
  mutate(depression_level = factor(depression_level, c(&quot;Normal&quot;,&quot;Mild&quot;,&quot;Moderate&quot;,&quot;Severe&quot;,&quot;Extremely severe&quot;))) %&gt;%
  dplyr::select(-depression)

head(dass_new)</code></pre>
<pre><code>##   country             education    urban gender age             religion
## 1      IN           High school    Urban Female  16                Other
## 3      PL           High school    Urban Female  17 Christian (Catholic)
## 4      US Less than high school    Urban Female  13 Christian (Catholic)
## 5      MY     University degree Suburban Female  19               Muslim
## 6      US           High school    Urban Female  20 Christian (Catholic)
## 7      MX           High school    Urban Female  17    Christian (Other)
##    orientation  race       married depression_level
## 1 Heterosexual Asian Never married           Severe
## 3   Homosexual White Never married Extremely severe
## 4        Other Other Never married         Moderate
## 5 Heterosexual Asian Never married Extremely severe
## 6 Heterosexual Other Never married             Mild
## 7     Bisexual White Never married Extremely severe</code></pre>
</div>
<div id="data-summary" class="section level3">
<h3>Data Summary</h3>
<p>Above all, we got our dataset for further analysis. It contains 30309
observations and 10 variables. The explanation of each variables are
listed below:</p>
<ul>
<li><p><code>country</code>: The country where the participants
from.</p></li>
<li><p><code>education</code>: The education level of the
participants.</p></li>
<li><p><code>urban</code>: The urban level of the place where
participants live.</p></li>
<li><p><code>gender</code>: The sex of the participants.</p></li>
<li><p><code>religion</code>: The religion which the participants belong
to.</p></li>
<li><p><code>orientation</code>: The sexual orientation of the
participants.</p></li>
<li><p><code>race</code>: The race of participants.</p></li>
<li><p><code>married</code>: The marriage status of
participants.</p></li>
<li><p><code>age</code>: The age when participants response the
survey.</p></li>
<li><p><code>depression_level</code>: The depression level of the
participants according to the survey and scores.</p></li>
</ul>
<pre class="r"><code>dass_new %&gt;%
  dplyr::select(-country) %&gt;%
  tbl_summary(type = list(
    education ~ &quot;categorical&quot;, 
    urban ~ &quot;categorical&quot;, 
    gender ~ &quot;categorical&quot;,
    religion ~ &quot;categorical&quot;,
    orientation ~ &quot;categorical&quot;,
    race ~ &quot;categorical&quot;,
    married ~ &quot;categorical&quot;,
    age ~ &quot;continuous&quot;, 
    depression_level ~ &quot;categorical&quot;
  ), 
  statistic = list(all_continuous() ~ &quot;{mean} ({sd})&quot;), 
  digits = all_continuous() ~ 1,
  label = c(
    education = &quot;Education level&quot;,
    urban = &quot;Urban level&quot;,
    gender = &quot;Gender&quot;,
    religion = &quot;Religion&quot;,
    orientation = &#39;Sexual orientation&#39;,
    race = &#39;Race&#39;,
    married = &#39;Marriage status&#39;,
    age = &quot;Age (Years)&quot;,
    depression_level = &quot;Depression level&quot;
  )) %&gt;%
  bold_labels() %&gt;%
  as_gt()  # Display the table as a gt object</code></pre>
<div id="sdztibuwbx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#sdztibuwbx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sdztibuwbx thead, #sdztibuwbx tbody, #sdztibuwbx tfoot, #sdztibuwbx tr, #sdztibuwbx td, #sdztibuwbx th {
  border-style: none;
}

#sdztibuwbx p {
  margin: 0;
  padding: 0;
}

#sdztibuwbx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sdztibuwbx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sdztibuwbx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sdztibuwbx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sdztibuwbx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sdztibuwbx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sdztibuwbx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sdztibuwbx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sdztibuwbx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sdztibuwbx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sdztibuwbx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sdztibuwbx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sdztibuwbx .gt_spanner_row {
  border-bottom-style: hidden;
}

#sdztibuwbx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sdztibuwbx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sdztibuwbx .gt_from_md > :first-child {
  margin-top: 0;
}

#sdztibuwbx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sdztibuwbx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sdztibuwbx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#sdztibuwbx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sdztibuwbx .gt_row_group_first td {
  border-top-width: 2px;
}

#sdztibuwbx .gt_row_group_first th {
  border-top-width: 2px;
}

#sdztibuwbx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sdztibuwbx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sdztibuwbx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sdztibuwbx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sdztibuwbx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sdztibuwbx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sdztibuwbx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sdztibuwbx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sdztibuwbx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sdztibuwbx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sdztibuwbx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sdztibuwbx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sdztibuwbx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sdztibuwbx .gt_left {
  text-align: left;
}

#sdztibuwbx .gt_center {
  text-align: center;
}

#sdztibuwbx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sdztibuwbx .gt_font_normal {
  font-weight: normal;
}

#sdztibuwbx .gt_font_bold {
  font-weight: bold;
}

#sdztibuwbx .gt_font_italic {
  font-style: italic;
}

#sdztibuwbx .gt_super {
  font-size: 65%;
}

#sdztibuwbx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sdztibuwbx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sdztibuwbx .gt_indent_1 {
  text-indent: 5px;
}

#sdztibuwbx .gt_indent_2 {
  text-indent: 10px;
}

#sdztibuwbx .gt_indent_3 {
  text-indent: 15px;
}

#sdztibuwbx .gt_indent_4 {
  text-indent: 20px;
}

#sdztibuwbx .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Characteristic&lt;/strong&gt;"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;N = 30,309&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;"><strong>N = 30,309</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">Education level</td>
<td headers="stat_0" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Less than high school</td>
<td headers="stat_0" class="gt_row gt_center">2,997 (9.9%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    High school</td>
<td headers="stat_0" class="gt_row gt_center">11,374 (38%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    University degree</td>
<td headers="stat_0" class="gt_row gt_center">11,957 (39%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Graduate degree</td>
<td headers="stat_0" class="gt_row gt_center">3,981 (13%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">Urban level</td>
<td headers="stat_0" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Rural</td>
<td headers="stat_0" class="gt_row gt_center">6,295 (21%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Suburban</td>
<td headers="stat_0" class="gt_row gt_center">10,283 (34%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Urban</td>
<td headers="stat_0" class="gt_row gt_center">13,731 (45%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">Gender</td>
<td headers="stat_0" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Female</td>
<td headers="stat_0" class="gt_row gt_center">23,137 (76%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Male</td>
<td headers="stat_0" class="gt_row gt_center">6,754 (22%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Other</td>
<td headers="stat_0" class="gt_row gt_center">418 (1.4%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">Age (Years)</td>
<td headers="stat_0" class="gt_row gt_center">23.5 (8.4)</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">Religion</td>
<td headers="stat_0" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Agnostic</td>
<td headers="stat_0" class="gt_row gt_center">2,406 (7.9%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Atheist</td>
<td headers="stat_0" class="gt_row gt_center">2,943 (9.7%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Buddhist</td>
<td headers="stat_0" class="gt_row gt_center">419 (1.4%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Christian (Catholic)</td>
<td headers="stat_0" class="gt_row gt_center">2,359 (7.8%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Christian (Mormon)</td>
<td headers="stat_0" class="gt_row gt_center">83 (0.3%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Christian (Other)</td>
<td headers="stat_0" class="gt_row gt_center">1,699 (5.6%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Christian (Protestant)</td>
<td headers="stat_0" class="gt_row gt_center">1,177 (3.9%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Hindu</td>
<td headers="stat_0" class="gt_row gt_center">531 (1.8%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Jewish</td>
<td headers="stat_0" class="gt_row gt_center">101 (0.3%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Muslim</td>
<td headers="stat_0" class="gt_row gt_center">17,204 (57%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Other</td>
<td headers="stat_0" class="gt_row gt_center">1,343 (4.4%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Sikh</td>
<td headers="stat_0" class="gt_row gt_center">44 (0.1%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">Sexual orientation</td>
<td headers="stat_0" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Asexual</td>
<td headers="stat_0" class="gt_row gt_center">1,649 (5.4%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Bisexual</td>
<td headers="stat_0" class="gt_row gt_center">3,921 (13%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Heterosexual</td>
<td headers="stat_0" class="gt_row gt_center">20,259 (67%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Homosexual</td>
<td headers="stat_0" class="gt_row gt_center">1,548 (5.1%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Other</td>
<td headers="stat_0" class="gt_row gt_center">2,932 (9.7%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">Race</td>
<td headers="stat_0" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Arab</td>
<td headers="stat_0" class="gt_row gt_center">228 (0.8%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Asian</td>
<td headers="stat_0" class="gt_row gt_center">18,041 (60%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Black</td>
<td headers="stat_0" class="gt_row gt_center">432 (1.4%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Indigenous Australian</td>
<td headers="stat_0" class="gt_row gt_center">12 (&lt;0.1%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Native American</td>
<td headers="stat_0" class="gt_row gt_center">159 (0.5%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Other</td>
<td headers="stat_0" class="gt_row gt_center">3,621 (12%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    White</td>
<td headers="stat_0" class="gt_row gt_center">7,816 (26%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">Marriage status</td>
<td headers="stat_0" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Previously married</td>
<td headers="stat_0" class="gt_row gt_center">771 (2.5%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Currently married</td>
<td headers="stat_0" class="gt_row gt_center">3,331 (11%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Never married</td>
<td headers="stat_0" class="gt_row gt_center">26,207 (86%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">Depression level</td>
<td headers="stat_0" class="gt_row gt_center"><br /></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Normal</td>
<td headers="stat_0" class="gt_row gt_center">6,832 (23%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Mild</td>
<td headers="stat_0" class="gt_row gt_center">2,921 (9.6%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Moderate</td>
<td headers="stat_0" class="gt_row gt_center">5,433 (18%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Severe</td>
<td headers="stat_0" class="gt_row gt_center">4,947 (16%)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Extremely severe</td>
<td headers="stat_0" class="gt_row gt_center">10,176 (34%)</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="2"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> n (%); Mean (SD)</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<div id="exploratory-analysis" class="section level2">
<h2><em>Exploratory Analysis</em></h2>
<p>The data we used to analyze potential factors of depression levels
comes from a worldwide survey. The raw data includes 9 potential
factors:<code>country</code>, <code>education</code>,
<code>urban</code>, <code>gender</code>, <code>religion</code>,
<code>orientation</code>, <code>race</code>, <code>married</code>, and
<code>age</code>. We would like to focus on <code>country</code>,
<code>orientation</code>, <code>gender</code>, <code>age</code>, and
<code>race</code> to analyze the relationship between these factors and
depression level.</p>
<div id="interactive-world-map" class="section level3">
<h3>Interactive World Map</h3>
<p>We designed a <a
href="https://doloreshqq.shinyapps.io/r_shiny_for_p8105/">shiny app</a>
to provide visualizations of depression levels for individual countries
on a global scale.</p>
<p>The sidebar can be used to select different depression levels, and
for the analysis of survey answers based on proportion or
occurrence.</p>
<p>A screenshot is shown below:</p>
<p><img src="shiny_scr.jpg" style="width:85%"/></p>
<p>This interactive graph also illustrates the imbalance of responses.
If we limit the occurrences to be larger than 500, there will only be
Malaysia and United States left. When interpreting the proportion of
different depression level, the sample size must be considered.</p>
</div>
<div id="plots-of-potential-factors-across-depression-levels"
class="section level3">
<h3>Plots of Potential Factors across Depression Levels</h3>
<p>With our existence data, we need to evaluate the depression level
with respect to different populations. After some preliminary research
and plotting, we identified a potential correlation between four
variables including <code>gender</code>, <code>orientation</code>,
<code>age</code> ,<code>race</code> and our predictor Depression Level.
Subsequently, we proceeded with following exploratory data analysis to
identify pertinent variables that could function as independent
variables in our regression model.</p>
<div id="overall-view-of-gender-orientation-depression"
class="section level4">
<h4>Overall view of gender, orientation &amp; depression</h4>
<p>Our first plot gives an overall view of the relationship with gender,
orientation and depression level.</p>
<p>The plot below shows the number of different depression level cases
in each gender groups among orientation.</p>
<pre class="r"><code>dass_new|&gt;
  group_by(gender, orientation)|&gt;
  summarise(Normal = sum(depression_level==&quot;Normal&quot;),
          Mild = sum(depression_level==&quot;Mild&quot;),
          Moderate = sum(depression_level==&quot;Moderate&quot;),
          Severe = sum(depression_level==&quot;Severe&quot;),
          Extremely_Severe = sum(depression_level==&quot;Extremely severe&quot;),
          .groups = &quot;keep&quot;)|&gt;
  pivot_longer(
    Normal:Extremely_Severe,
    names_to = &quot;Level&quot;,
    values_to = &quot;count&quot;)|&gt;
  mutate(Level = factor(Level, levels = unique(Level)))|&gt;
  ggplot(aes(x = Level, y = count, fill= gender)) +
  geom_col()+
  theme_minimal()+
  facet_grid(~orientation)+
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(x = &quot;Depression level&quot;, 
       y = &quot;count of cases&quot;, 
       title = &quot;Depression level vs. orientation vs. gender&quot;)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>The x axis illustrates depression levels categorized by various
orientations, while the y axis denotes the count of cases. Additionally,
the bar plot’s proportional filling conveys the gender distribution
within a particular depression level under each orientation. From the
plot, we observed that the female gender group in all orientation
categories tends to exhibit a higher number of depression cases compared
to other gender groups. Also, we found that depression level has
significant differences between distinct orientation groups and genders.
So we would like to further investigate the correlation between
depression levels and each factor individually.</p>
</div>
<div id="orientation" class="section level4">
<h4>Orientation</h4>
<p>Next, we would like to delve deeper into studying the relationship
between the level of depression and orientation.</p>
<pre class="r"><code>dass_new|&gt;
  group_by(orientation)|&gt;
  summarise(Normal = sum(depression_level==&quot;Normal&quot;),
            Mild = sum(depression_level==&quot;Mild&quot;),
            Moderate = sum(depression_level==&quot;Moderate&quot;),
            Severe = sum(depression_level==&quot;Severe&quot;),
            Extremely_Severe = sum(depression_level==&quot;Extremely severe&quot;))|&gt;
  pivot_longer(
    Normal:Extremely_Severe,
    names_to = &quot;Level&quot;,
    values_to = &quot;Count&quot;)|&gt;
  mutate(Level = factor(Level, levels = unique(Level)))|&gt;
  ggplot(aes(x = Level, y = Count, group = orientation, color = orientation)) +
  geom_point()+
  geom_line()+
  theme_minimal()+
  labs(x = &quot;Depression level&quot;, 
       y = &quot;count of cases&quot;, 
       title = &quot;Depression level vs. orientation groups&quot;)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>This plot shows the relationship between depression levels and
orientations. Given that heterosexual data is the most abundant, it
naturally exhibits the highest case count. However, our primary emphasis
in this analysis is on discerning the overarching trends across various
depression levels.Notably, we observe fluctuations in individuals
identifying as Heterosexual across depression levels, while there is a
conspicuous rise in count among Bisexual individuals as the severity of
depression increases. Asexual and Homosexual individuals display a
relatively even distribution across all levels. The “Other” category
exhibits a low count for “Mild” but experiences an increase with
severity, peaking at the “Extremely Severe” level.</p>
</div>
<div id="gender" class="section level4">
<h4>Gender</h4>
<pre class="r"><code># distribution histogram of gender
dass_new|&gt;
  group_by(gender)|&gt;
  summarise(Normal = sum(depression_level==&quot;Normal&quot;),
            Mild = sum(depression_level==&quot;Mild&quot;),
            Moderate = sum(depression_level==&quot;Moderate&quot;),
            Severe = sum(depression_level==&quot;Severe&quot;),
            Extremely_Severe = sum(depression_level==&quot;Extremely severe&quot;))|&gt;
  pivot_longer(
    Normal:Extremely_Severe,
    names_to = &quot;Level&quot;,
    values_to = &quot;Count&quot;)|&gt;
  mutate(Level = factor(Level, levels = unique(Level)))|&gt;
  ggplot(aes(x = Level, y = Count, group = gender, color = gender)) +
  geom_point()+
  geom_line()+
  theme_minimal()+
  labs(x = &quot;Depression level&quot;, 
       y = &quot;count of cases&quot;, 
       title = &quot;Depression level vs. gender groups&quot;)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>In our third plot, it becomes evident that females consistently
exhibit a notably higher count of depression cases across all levels,
especially in the “Normal” and “Extremely Severe” levels. Conversely,
males display a lower case count at all levels, with a slight decrease
at “Mild” followed by an increase at “Moderate.” The case count for the
“Other” gender category remains relatively stable across all levels of
depression.</p>
</div>
<div id="race" class="section level4">
<h4>Race</h4>
<pre class="r"><code>dass_new|&gt;
  # form new race groups
  mutate(race = case_when(race == &quot;Native American&quot; ~ &quot;Other&quot;,
                          race==&quot;Arab&quot;~ &quot;Other&quot;, 
                          race == &quot;Indigenous Australian&quot; ~ &quot;Other&quot;,
                          race == &quot;Other&quot; ~ &quot;Other&quot;,
                          race == &quot;Black&quot; ~ &quot;Black&quot;,
                          race == &quot;White&quot; ~ &quot;White&quot;,
                          race == &quot;Asian&quot; ~ &quot;Asian&quot;))|&gt;
  group_by(race)|&gt;
  summarise(Normal = sum(depression_level==&quot;Normal&quot;),
            Mild = sum(depression_level==&quot;Mild&quot;),
            Moderate = sum(depression_level==&quot;Moderate&quot;),
            Severe = sum(depression_level==&quot;Severe&quot;),
            Extremely_Severe = sum(depression_level==&quot;Extremely severe&quot;))|&gt;
  pivot_longer(
    Normal:Extremely_Severe,
    names_to = &quot;Level&quot;,
    values_to = &quot;Count&quot;)|&gt;
  mutate(Level = factor(Level, levels = unique(Level)))|&gt;
  ggplot(aes(x = Level, y = Count, group = race, color = race)) +
  geom_point()+
  geom_line()+
  theme_minimal()+
  labs(x = &quot;Depression level&quot;, 
       y = &quot;count of cases&quot;, 
       title = &quot;Depression level vs. race groups&quot;)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>The fourth plot examines depression levels across various races. The
Asian group demonstrates the most fluctuating trend, with notable values
at “Normal” and “Extremely Severe.” The White group and other racial
categories exhibit similar trends, showing a slight decrease at “Mild”
and a substantial increase at “Extremely Severe.” In contrast, Black
individuals maintain a consistent count across all levels of
depression.</p>
</div>
<div id="age" class="section level4">
<h4>Age</h4>
<pre class="r"><code>dass_new %&gt;%
  ggplot(aes(x=depression_level, y=age)) +
  geom_boxplot(aes(fill=depression_level)) +
  labs(title = &quot;Age Distribution for Each Depression Level&quot;,
        xlab = &quot;Depression Level&quot;,
        ylab = &quot;Age&quot;)+
  theme_minimal()</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Regarding the age variable, we examined the box plot representing the
general distribution of age and depression level. Our observation
revealed the presence of numerous outliers. Across all depression
levels, the data predominantly centered on the teenage age groups around
18~25. Thus we divided age into four groups(under 18, 18 ~ 25, 25 ~ 50
and 50+) in next step.</p>
<pre class="r"><code>dass_new|&gt;
  # form age groups
  mutate(age = case_when(age &lt;= 18 ~ &quot;teenage&quot;, 
                         age &lt;= 25 &amp; age &gt;18 ~ &quot;young adult&quot;,
                         age &lt;= 50 &amp; age &gt;25 ~ &quot;adult&quot;, 
                         age &gt;50 ~ &quot;older&quot;))|&gt;
  group_by(age)|&gt;
  summarise(Normal = sum(depression_level==&quot;Normal&quot;),
            Mild = sum(depression_level==&quot;Mild&quot;),
            Moderate = sum(depression_level==&quot;Moderate&quot;),
            Severe = sum(depression_level==&quot;Severe&quot;),
            Extremely_Severe = sum(depression_level==&quot;Extremely severe&quot;))|&gt;
  pivot_longer(
    Normal:Extremely_Severe,
    names_to = &quot;Level&quot;,
    values_to = &quot;Count&quot;)|&gt;
  mutate(Level = factor(Level, levels = unique(Level)))|&gt;
  ggplot(aes(x = Level, y = Count, group = age, color = age)) +
  geom_line()+
  geom_point()+
  theme_minimal()+
  labs(x = &quot;Depression level&quot;, 
       y = &quot;count of cases&quot;, 
       title = &quot;Depression level vs. age groups&quot;)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>This plot reveals that young adults consistently exhibit the highest
counts of depression at all levels, experiencing a significant increase
at the “Extremely Severe” level. The teenage group has a lower case
count at the “Normal” level compared to the adult group but surpasses it
at the “Moderate” level. Older individuals maintain a relatively stable
count across all levels, with a slight increase at the “Extremely
Severe” level.</p>
</div>
</div>
</div>
<div id="additional-analysis" class="section level2">
<h2><em>Additional Analysis</em></h2>
<p>From the plots regarding the depression levels and factors, we
observed that the distribution of cases of different depression levels
among different orientation groups, the distribution of cases of
different depression levels among different gender groups, the
distribution of cases of different depression levels among different age
groups, and the distribution of cases of different depression levels
among different race groups follow a similar pattern. Thus, we would
like to perform a chi-squared test to study if these factors and
depression levels are associated.<br />
</p>
<div id="chi-squared-test" class="section level3">
<h3>Chi-squared Test</h3>
<div id="orientation-depression-level" class="section level4">
<h4>1: Orientation &amp; Depression Level</h4>
<p><span class="math inline">\(H_0\)</span>: The depression levels and
orientation are independent.<br />
<span class="math inline">\(H_1\)</span>: The depression levels and
orientation are associated.</p>
<pre class="r"><code># show result table to perform chi-squared test
dass_new|&gt;
  group_by(orientation)|&gt;
  summarise(Normal = sum(depression_level==&quot;Normal&quot;),
            Mild = sum(depression_level==&quot;Mild&quot;),
            Moderate = sum(depression_level==&quot;Moderate&quot;),
            Severe = sum(depression_level==&quot;Severe&quot;),
            Extremely_Severe = sum(depression_level==&quot;Extremely severe&quot;))</code></pre>
<pre><code>## # A tibble: 5 × 6
##   orientation  Normal  Mild Moderate Severe Extremely_Severe
##   &lt;chr&gt;         &lt;int&gt; &lt;int&gt;    &lt;int&gt;  &lt;int&gt;            &lt;int&gt;
## 1 Asexual         354   139      267    282              607
## 2 Bisexual        588   304      655    665             1709
## 3 Heterosexual   5040  2053     3722   3238             6206
## 4 Homosexual      273   142      276    254              603
## 5 Other           577   283      513    508             1051</code></pre>
<pre class="r"><code># perform chi-squared test
chisq.test(pull(dass_new, orientation), pull(dass_new, depression_level))|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">parameter</th>
<th align="left">method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">404.2459</td>
<td align="right">0</td>
<td align="right">16</td>
<td align="left">Pearson’s Chi-squared test</td>
</tr>
</tbody>
</table>
<p>The null hypothesis for the chi-squared test is that the depression
levels and orientation are independent. Since the p-value is smaller
than 0.05, the null hypothesis is rejected.<br />
We may conclude that orientation is associated with depression
levels.</p>
</div>
<div id="gender-depression-level" class="section level4">
<h4>2: Gender &amp; Depression Level</h4>
<p><span class="math inline">\(H_0\)</span>: The depression levels and
gender are independent.<br />
<span class="math inline">\(H_1\)</span>: The depression levels and
gender are associated.</p>
<pre class="r"><code># show result table to perform chi-squared test
dass_new|&gt;
  group_by(gender)|&gt;
  summarise(Normal = sum(depression_level==&quot;Normal&quot;),
            Mild = sum(depression_level==&quot;Mild&quot;),
            Moderate = sum(depression_level==&quot;Moderate&quot;),
            Severe = sum(depression_level==&quot;Severe&quot;),
            Extremely_Severe = sum(depression_level==&quot;Extremely severe&quot;))</code></pre>
<pre><code>## # A tibble: 3 × 6
##   gender Normal  Mild Moderate Severe Extremely_Severe
##   &lt;chr&gt;   &lt;int&gt; &lt;int&gt;    &lt;int&gt;  &lt;int&gt;            &lt;int&gt;
## 1 Female   5073  2254     4208   3813             7789
## 2 Male     1723   644     1158   1067             2162
## 3 Other      36    23       67     67              225</code></pre>
<pre class="r"><code># perform chi-squared test
chisq.test(pull(dass_new, gender), pull(dass_new, depression_level))|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">parameter</th>
<th align="left">method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">135.6119</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="left">Pearson’s Chi-squared test</td>
</tr>
</tbody>
</table>
<p>The null hypothesis for the chi-squared test is that the depression
levels and gender are independent. Since the p-value is smaller than
0.05, the null hypothesis is rejected.<br />
We may conclude that gender is associated with depression levels.</p>
</div>
<div id="age-depression-level" class="section level4">
<h4>3: Age &amp; Depression Level</h4>
<p><span class="math inline">\(H_0\)</span>: The depression levels and
age are independent.<br />
<span class="math inline">\(H_1\)</span>: The depression levels and age
are associated.</p>
<pre class="r"><code>dass_chi &lt;- dass_new|&gt;
  # form age groups
  mutate(age = case_when(age &lt;= 18 ~ &quot;teenage&quot;, 
                         age &lt;= 25 &amp; age &gt;18 ~ &quot;young adult&quot;,
                         age &lt;= 50 &amp; age &gt;25 ~ &quot;adult&quot;, 
                         age &gt;50 ~ &quot;older&quot;))
# show result table to perform chi-squared test
dass_chi|&gt;
  group_by(age)|&gt;
  summarise(Normal = sum(depression_level==&quot;Normal&quot;),
            Mild = sum(depression_level==&quot;Mild&quot;),
            Moderate = sum(depression_level==&quot;Moderate&quot;),
            Severe = sum(depression_level==&quot;Severe&quot;),
            Extremely_Severe = sum(depression_level==&quot;Extremely severe&quot;))</code></pre>
<pre><code>## # A tibble: 4 × 6
##   age         Normal  Mild Moderate Severe Extremely_Severe
##   &lt;chr&gt;        &lt;int&gt; &lt;int&gt;    &lt;int&gt;  &lt;int&gt;            &lt;int&gt;
## 1 adult         1949   709     1176    934             1789
## 2 older          240    64      116     75              192
## 3 teenage       1235   555     1256   1327             3105
## 4 young adult   3408  1593     2885   2611             5090</code></pre>
<pre class="r"><code># perform chi-squared test
chisq.test(pull(dass_chi, age), pull(dass_chi, depression_level))|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">parameter</th>
<th align="left">method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">651.3207</td>
<td align="right">0</td>
<td align="right">12</td>
<td align="left">Pearson’s Chi-squared test</td>
</tr>
</tbody>
</table>
<p>The null hypothesis for the chi-squared test is that depression
levels and age are independent. Since the p-value is smaller than 0.05,
the null hypothesis is rejected.<br />
We may conclude that age is associated with depression levels.</p>
</div>
<div id="race-depression-level" class="section level4">
<h4>4: Race &amp; Depression Level</h4>
<p><span class="math inline">\(H_0\)</span>: The depression levels and
race groups are independent.<br />
<span class="math inline">\(H_1\)</span>: The depression levels and race
groups are associated.</p>
<pre class="r"><code>dass_chi &lt;- dass_new|&gt;
  # form new race groups
  mutate(race = case_when(race == &quot;Native American&quot; ~ &quot;Other&quot;,
                          race==&quot;Arab&quot;~ &quot;Other&quot;, 
                          race == &quot;Indigenous Australian&quot; ~ &quot;Other&quot;,
                          race == &quot;Other&quot; ~ &quot;Other&quot;,
                          race == &quot;Black&quot; ~ &quot;Black&quot;,
                          race == &quot;White&quot; ~ &quot;White&quot;,
                          race == &quot;Asian&quot; ~ &quot;Asian&quot;))
# show result table to perform chi-squared test
dass_chi|&gt;
  group_by(race)|&gt;
  summarise(Normal = sum(depression_level==&quot;Normal&quot;),
            Mild = sum(depression_level==&quot;Mild&quot;),
            Moderate = sum(depression_level==&quot;Moderate&quot;),
            Severe = sum(depression_level==&quot;Severe&quot;),
            Extremely_Severe = sum(depression_level==&quot;Extremely severe&quot;))</code></pre>
<pre><code>## # A tibble: 4 × 6
##   race  Normal  Mild Moderate Severe Extremely_Severe
##   &lt;chr&gt;  &lt;int&gt; &lt;int&gt;    &lt;int&gt;  &lt;int&gt;            &lt;int&gt;
## 1 Asian   4254  1851     3368   2944             5624
## 2 Black    105    30       64     71              162
## 3 Other    893   378      682    679             1388
## 4 White   1580   662     1319   1253             3002</code></pre>
<pre class="r"><code># perform chi-squared test
chisq.test(pull(dass_chi, race), pull(dass_chi, depression_level))|&gt;
  broom::tidy()|&gt;
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">parameter</th>
<th align="left">method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">154.3871</td>
<td align="right">0</td>
<td align="right">12</td>
<td align="left">Pearson’s Chi-squared test</td>
</tr>
</tbody>
</table>
<p>The null hypothesis for the chi-squared test is that depression
levels and race groups are independent. Since the p-value is smaller
than 0.05, the null hypothesis is rejected.<br />
We may conclude that race is associated with depression levels.</p>
<p>Based on the performed tests, orientation, gender, age, and race are
strongly associated with depression levels.</p>
</div>
</div>
</div>
<div id="regression" class="section level2">
<h2><em>Regression</em></h2>
<p>We want to investigate the relationship between demographic variables
and depression levels. Because the dependent variable depression_level
is an ordinal variable with five levels (“Normal”, “Mild”, “Moderate”,
“Severe”, “Extremely severe”), we choose to fit an <em>ordered logit
model</em>.</p>
<div id="independent-variables" class="section level3">
<h3>Independent Variables</h3>
<p>Imbalanced data may result in an inaccurate outcome due to a small
sample size in some classes. Therefore, we first want to test the
distribution of independent variables to avoid the imbalance of samples
between different categories.</p>
<pre class="r"><code>dass_new = read_csv(&quot;data/dass_new.csv&quot;)

dass_new |&gt; 
  dplyr::select(age, everything()) |&gt; 
  mutate(across(country:depression_level, factor)) |&gt; 
  summary()</code></pre>
<pre><code>##       age           country                      education          urban      
##  Min.   :13.00   MY     :16932   Graduate degree      : 3981   Rural   : 6295  
##  1st Qu.:19.00   US     : 5989   High school          :11374   Suburban:10283  
##  Median :21.00   GB     :  891   Less than high school: 2997   Urban   :13731  
##  Mean   :23.45   CA     :  752   University degree    :11957                   
##  3rd Qu.:25.00   ID     :  746                                                 
##  Max.   :99.00   PH     :  581                                                 
##                  (Other): 4418                                                 
##     gender                      religion           orientation   
##  Female:23137   Muslim              :17204   Asexual     : 1649  
##  Male  : 6754   Atheist             : 2943   Bisexual    : 3921  
##  Other :  418   Agnostic            : 2406   Heterosexual:20259  
##                 Christian (Catholic): 2359   Homosexual  : 1548  
##                 Christian (Other)   : 1699   Other       : 2932  
##                 Other               : 1343                       
##                 (Other)             : 2355                       
##                     race                     married     
##  Arab                 :  228   Currently married : 3331  
##  Asian                :18041   Never married     :26207  
##  Black                :  432   Previously married:  771  
##  Indigenous Australian:   12                             
##  Native American      :  159                             
##  Other                : 3621                             
##  White                : 7816                             
##          depression_level
##  Extremely severe:10176  
##  Mild            : 2921  
##  Moderate        : 5433  
##  Normal          : 6832  
##  Severe          : 4947  
##                          
## </code></pre>
<p>Some categories contain few samples (e.g. countries other than the
listed six countries have less than 500 samples). For the efficacy of
the model and considering which class most interests us, we regroup the
independent variables following the standards below:</p>
<ul>
<li><code>country</code>: Group the country with less than 500 samples
into “Other”, and set “US” to be the reference level.</li>
<li><code>education</code>: Order the variable by the length of
education.</li>
<li><code>race</code>: We follow <a
href="https://www.govinfo.gov/content/pkg/FR-1997-10-30/pdf/97-28653.pdf">standards
on race and ethnicity</a> to include only “Asian”, “Black”, “Native
American”, “White”, and make other categories “Other”. We set “White” to
be the reference level.</li>
<li><code>religion</code>: We conclude “Christian (Catholic)”,
“Christian (Mormon)”, “Christian (Other)”, “Christian (Protestant)” into
“Christian”, and set it as the reference level.</li>
<li><code>orientation</code>: Set the “Heterosexual” to be the reference
level.</li>
<li><code>married</code>: Order the variable by marriage status.</li>
</ul>
<pre class="r"><code>dass_fit_df =
  dass_new |&gt; 
  mutate(
    country = relevel(as.factor(ifelse(country %in% c(&quot;MY&quot;, &quot;US&quot;, &quot;GB&quot;, &quot;CA&quot;, &quot;ID&quot;, &quot;PH&quot;), country, &quot;Other&quot;)), ref = &quot;US&quot;),
    education = factor(education, levels = c(&quot;Less than high school&quot;, &quot;High school&quot;, &quot;University degree&quot;, &quot;Graduate degree&quot;)),
    race = relevel(as.factor(ifelse(race %in% c(&quot;Arab&quot;, &quot;Indigenous Australian&quot;), &quot;Other&quot;, race)), ref = &quot;White&quot;),
    religion = relevel(as.factor(ifelse(substr(religion, 1, 9) == &quot;Christian&quot;, &quot;Christian&quot;, religion)), &quot;Christian&quot;),
    orientation = relevel(as.factor(orientation), &quot;Heterosexual&quot;),
    married = factor(married, levels = c(&quot;Never married&quot;, &quot;Currently married&quot;, &quot;Previously married&quot;)),
    depression_level = factor(depression_level, levels = c(&quot;Normal&quot;, &quot;Mild&quot;, &quot;Moderate&quot;, &quot;Severe&quot;, &quot;Extremely severe&quot;))
  )

dass_fit_df |&gt; summary()</code></pre>
<pre><code>##   country                      education        urban          
##  US   : 5989   Less than high school: 2997   Length:30309      
##  CA   :  752   High school          :11374   Class :character  
##  GB   :  891   University degree    :11957   Mode  :character  
##  ID   :  746   Graduate degree      : 3981                     
##  MY   :16932                                                   
##  Other: 4418                                                   
##  PH   :  581                                                   
##     gender               age             religion           orientation   
##  Length:30309       Min.   :13.00   Muslim   :17204   Heterosexual:20259  
##  Class :character   1st Qu.:19.00   Christian: 5318   Asexual     : 1649  
##  Mode  :character   Median :21.00   Atheist  : 2943   Bisexual    : 3921  
##                     Mean   :23.45   Agnostic : 2406   Homosexual  : 1548  
##                     3rd Qu.:25.00   Other    : 1343   Other       : 2932  
##                     Max.   :99.00   Hindu    :  531                       
##                                     (Other)  :  564                       
##               race                     married              depression_level
##  White          : 7816   Never married     :26207   Normal          : 6832  
##  Asian          :18041   Currently married : 3331   Mild            : 2921  
##  Black          :  432   Previously married:  771   Moderate        : 5433  
##  Native American:  159                              Severe          : 4947  
##  Other          : 3861                              Extremely severe:10176  
##                                                                             
## </code></pre>
</div>
<div id="model-fitting" class="section level3">
<h3>Model Fitting</h3>
<p>First fit a model without variables selection.</p>
<pre class="r"><code>dass_fit =
  dass_fit_df |&gt; 
  polr(depression_level ~ ., data = _)

(fit_s = 
  dass_fit |&gt; 
  summary())</code></pre>
<pre><code>## 
## Re-fitting to get Hessian</code></pre>
<pre><code>## Call:
## polr(formula = depression_level ~ ., data = dass_fit_df)
## 
## Coefficients:
##                                Value Std. Error  t value
## countryCA                   0.148517   0.071130   2.0880
## countryGB                   0.171354   0.067062   2.5552
## countryID                   0.043053   0.079163   0.5439
## countryMY                  -0.008007   0.050543  -0.1584
## countryOther                0.102717   0.039048   2.6305
## countryPH                   0.264462   0.087392   3.0262
## educationHigh school       -0.150185   0.040509  -3.7075
## educationUniversity degree -0.376834   0.044291  -8.5082
## educationGraduate degree   -0.530279   0.052303 -10.1386
## urbanSuburban              -0.027283   0.029139  -0.9363
## urbanUrban                  0.046331   0.027761   1.6689
## genderMale                 -0.166471   0.025998  -6.4032
## genderOther                 0.339713   0.096112   3.5346
## age                        -0.007523   0.001868  -4.0267
## religionAgnostic            0.187629   0.046183   4.0627
## religionAtheist             0.260434   0.044725   5.8230
## religionBuddhist           -0.210089   0.095058  -2.2101
## religionHindu               0.099165   0.087998   1.1269
## religionJewish             -0.044442   0.184671  -0.2407
## religionMuslim              0.019758   0.045019   0.4389
## religionOther               0.193342   0.056459   3.4245
## religionSikh                0.036949   0.272258   0.1357
## orientationAsexual          0.173086   0.046812   3.6975
## orientationBisexual         0.374809   0.032818  11.4208
## orientationHomosexual       0.286605   0.048017   5.9688
## orientationOther            0.195966   0.036306   5.3976
## raceAsian                  -0.091787   0.044414  -2.0666
## raceBlack                  -0.101452   0.091268  -1.1116
## raceNative American         0.136167   0.146638   0.9286
## raceOther                  -0.063766   0.044043  -1.4478
## marriedCurrently married   -0.528618   0.040748 -12.9730
## marriedPreviously married   0.041553   0.075500   0.5504
## 
## Intercepts:
##                         Value    Std. Error t value 
## Normal|Mild              -1.6935   0.0604   -28.0233
## Mild|Moderate            -1.1882   0.0600   -19.8029
## Moderate|Severe          -0.4097   0.0597    -6.8678
## Severe|Extremely severe   0.2936   0.0597     4.9209
## 
## Residual Deviance: 91341.20 
## AIC: 91413.20</code></pre>
<p>When conducting an ordered logit model, the underlying assumption is
that the coefficients that describe the relationship between, say, the
lowest versus all higher categories of the response variable are the
same as those that describe the relationship between the next lowest
category and all higher categories, etc. This is called the proportional
odds assumption or the parallel assumption.</p>
<p>Now, we want to test if the model conducted meets the parallel
assumption.</p>
<pre class="r"><code>car::poTest(dass_fit)</code></pre>
<pre><code>## 
## Tests for Proportional Odds
## polr(formula = depression_level ~ ., data = dass_fit_df)
## 
##                              b[polr] b[&gt;Normal]  b[&gt;Mild] b[&gt;Moderate]
## Overall                                                               
## countryCA                   1.49e-01   1.82e-01  1.54e-01     1.64e-01
## countryGB                   1.71e-01   2.21e-01  1.44e-01     1.46e-01
## countryID                   4.31e-02   1.63e-01  1.53e-02     4.50e-02
## countryMY                  -8.01e-03   1.10e-01 -9.42e-03    -2.97e-02
## countryOther                1.03e-01   9.00e-02  6.84e-02     1.29e-01
## countryPH                   2.64e-01   3.82e-01  3.76e-01     2.69e-01
## educationHigh school       -1.50e-01  -1.31e-01 -1.25e-01    -1.47e-01
## educationUniversity degree -3.77e-01  -3.64e-01 -3.57e-01    -3.86e-01
## educationGraduate degree   -5.30e-01  -5.59e-01 -5.32e-01    -5.07e-01
## urbanSuburban              -2.73e-02   1.83e-02  3.45e-02    -2.71e-02
## urbanUrban                  4.63e-02   7.74e-02  8.22e-02     4.57e-02
## genderMale                 -1.66e-01  -2.18e-01 -1.89e-01    -1.45e-01
## genderOther                 3.40e-01   6.00e-01  5.24e-01     3.05e-01
## age                        -7.52e-03  -1.18e-02 -1.06e-02    -8.09e-03
## religionAgnostic            1.88e-01   1.34e-01  1.90e-01     2.27e-01
## religionAtheist             2.60e-01   1.76e-01  2.38e-01     2.37e-01
## religionBuddhist           -2.10e-01  -3.18e-01 -1.88e-01    -2.02e-01
## religionHindu               9.92e-02   9.13e-02  3.07e-02     1.28e-01
## religionJewish             -4.44e-02  -1.28e-02 -1.91e-01     3.51e-02
## religionMuslim              1.98e-02   2.02e-02  8.06e-02     3.27e-02
## religionOther               1.93e-01   1.82e-01  1.80e-01     2.04e-01
## religionSikh                3.69e-02   1.24e-01  2.65e-01     6.49e-02
## orientationAsexual          1.73e-01   8.23e-02  1.37e-01     2.17e-01
## orientationBisexual         3.75e-01   4.36e-01  4.06e-01     3.67e-01
## orientationHomosexual       2.87e-01   3.52e-01  2.97e-01     2.59e-01
## orientationOther            1.96e-01   2.10e-01  1.87e-01     2.07e-01
## raceAsian                  -9.18e-02  -1.97e-01 -1.54e-01    -7.88e-02
## raceBlack                  -1.01e-01  -3.18e-01 -1.74e-01    -3.18e-02
## raceNative American         1.36e-01   2.45e-01  2.22e-01     2.19e-01
## raceOther                  -6.38e-02  -1.77e-01 -1.33e-01    -3.46e-02
## marriedCurrently married   -5.29e-01  -4.77e-01 -4.85e-01    -5.13e-01
## marriedPreviously married   4.16e-02   4.13e-02  5.71e-02     1.10e-01
##                            b[&gt;Severe] Chisquare df Pr(&gt;Chisq)    
## Overall                                  168.29 96    7.3e-06 ***
## countryCA                    1.14e-01      0.84  3      0.839    
## countryGB                    1.77e-01      1.80  3      0.615    
## countryID                    1.26e-02      4.70  3      0.195    
## countryMY                   -5.16e-02      8.85  3      0.031 *  
## countryOther                 1.05e-01      3.32  3      0.345    
## countryPH                    1.76e-01      3.33  3      0.344    
## educationHigh school        -1.86e-01      1.68  3      0.641    
## educationUniversity degree  -4.25e-01      1.64  3      0.650    
## educationGraduate degree    -5.42e-01      1.15  3      0.766    
## urbanSuburban               -8.24e-02     10.81  3      0.013 *  
## urbanUrban                   4.01e-03      5.40  3      0.145    
## genderMale                  -1.50e-01      5.67  3      0.129    
## genderOther                  2.99e-01      4.14  3      0.247    
## age                         -2.29e-04     30.13  3    1.3e-06 ***
## religionAgnostic             1.90e-01      3.47  3      0.325    
## religionAtheist              2.99e-01      5.55  3      0.136    
## religionBuddhist            -1.16e-01      4.70  3      0.195    
## religionHindu                1.20e-01      2.20  3      0.532    
## religionJewish              -3.46e-02      3.08  3      0.379    
## religionMuslim              -2.39e-02      5.67  3      0.129    
## religionOther                2.04e-01      0.20  3      0.978    
## religionSikh                -7.04e-02      1.22  3      0.748    
## orientationAsexual           2.06e-01      5.93  3      0.115    
## orientationBisexual          3.62e-01      2.64  3      0.450    
## orientationHomosexual        2.66e-01      2.27  3      0.519    
## orientationOther             1.85e-01      1.13  3      0.770    
## raceAsian                   -1.59e-02      8.57  3      0.036 *  
## raceBlack                   -1.11e-02      8.62  3      0.035 *  
## raceNative American          5.56e-02      1.39  3      0.709    
## raceOther                    1.15e-04      9.10  3      0.028 *  
## marriedCurrently married    -6.06e-01      6.76  3      0.080 .  
## marriedPreviously married   -8.04e-02      8.10  3      0.044 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Because the overall <span class="math inline">\(p-value &lt;
0.001\)</span>, we reject the null hypothesis and conclude that the
parallel assumption is not met.</p>
<p>To meet the parallel assumption, considering the variables of
interest in EDA, we try the following two methods:</p>
<ul>
<li><strong>Select independent variables</strong>: Because we think
<code>religion</code> and <code>race</code>, <code>married</code> and
<code>orientation</code>, <code>country</code> and <code>urban</code>
are strongly correlated with each other, and we care more about
<code>race</code>, <code>orientation</code>, and <code>country</code>,
first delete <code>religion</code>, <code>married</code>, and
<code>urban</code>. We also delete <code>education</code> to meet the
parallel assumption.</li>
<li><strong>Regroup dependent variable</strong>: Regroup
<code>depression_level</code> into “Moderate or Below”, “Severe”,
“Extremely severe”.</li>
</ul>
<pre class="r"><code>dass_fit_df =
  dass_fit_df |&gt; 
  mutate(depression_level = factor(case_match(
    depression_level,
    &quot;Normal&quot; ~ &quot;Moderate or Below&quot;,
    &quot;Mild&quot; ~ &quot;Moderate or Below&quot;,&quot;Moderate&quot; ~ &quot;Moderate or Below&quot;,
    &quot;Severe&quot; ~ &quot;Severe&quot;,
    &quot;Extremely severe&quot; ~ &quot;Extremely severe&quot;
   ), level = c(&quot;Moderate or Below&quot;, &quot;Severe&quot;, &quot;Extremely severe&quot;)))

dass_fit1 =
  dass_fit_df |&gt; 
  polr(depression_level ~ country + gender + age + orientation + race, data = _)

dass_fit1 |&gt; poTest()</code></pre>
<pre><code>## 
## Tests for Proportional Odds
## polr(formula = depression_level ~ country + gender + age + orientation + 
##     race, data = dass_fit_df)
## 
##                        b[polr] b[&gt;Moderate or Below] b[&gt;Severe] Chisquare df
## Overall                                                             26.43 17
## countryCA              0.17607               0.19690    0.15297      0.50  1
## countryGB              0.20429               0.19144    0.22882      0.46  1
## countryID             -0.03701              -0.01653   -0.06773      0.57  1
## countryMY             -0.18594              -0.16470   -0.22038      2.40  1
## countryOther           0.10529               0.11040    0.09276      0.30  1
## countryPH              0.13180               0.16664    0.09162      1.01  1
## genderMale            -0.10458              -0.10721   -0.10290      0.04  1
## genderOther            0.38262               0.38336    0.38755      0.00  1
## age                   -0.02532              -0.02674   -0.02206     17.25  1
## orientationAsexual     0.22638               0.23486    0.22828      0.03  1
## orientationBisexual    0.40403               0.40507    0.40757      0.01  1
## orientationHomosexual  0.29795               0.28623    0.30345      0.17  1
## orientationOther       0.22051               0.23073    0.21375      0.27  1
## raceAsian             -0.15662              -0.17315   -0.13328      1.31  1
## raceBlack             -0.08899              -0.07969   -0.07401      0.01  1
## raceNative American    0.10589               0.19327    0.02714      1.40  1
## raceOther             -0.10281              -0.11014   -0.09253      0.24  1
##                       Pr(&gt;Chisq)    
## Overall                    0.067 .  
## countryCA                  0.480    
## countryGB                  0.496    
## countryID                  0.451    
## countryMY                  0.121    
## countryOther               0.584    
## countryPH                  0.316    
## genderMale                 0.850    
## genderOther                0.960    
## age                      3.3e-05 ***
## orientationAsexual         0.873    
## orientationBisexual        0.929    
## orientationHomosexual      0.678    
## orientationOther           0.601    
## raceAsian                  0.252    
## raceBlack                  0.942    
## raceNative American        0.236    
## raceOther                  0.627    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The model meets the parallel assumption at <span
class="math inline">\(\alpha=0.05\)</span> level (with an overall <span
class="math inline">\(p = 0.067 &gt; 0.05\)</span>).</p>
<div id="depression-levels-distribution" class="section level4">
<h4>Depression Levels Distribution</h4>
<p>After selecting independent variables, we can further visualize the
data based on the effective covariates as well as the good stratum of
depression level.</p>
<pre class="r"><code># Create a data frame with the predictor values for visualization
predictor_data &lt;- model.matrix(depression_level ~ country + gender + age
                               + orientation + race, data = dass_fit_df)

# Compute the effects
effects &lt;- allEffects(dass_fit1, xlevels = list(predictor_data))

# Plot the effects
plot(effects, style = &quot;stacked&quot;)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-22-1.png" width="1920" /></p>
<p>The accompanying graphs display the probability of depression levels
across various categorical and continuous variables. For instance, the
trend depicted in the graph indicates higher rates of extreme depression
among young people.</p>
</div>
</div>
<div id="results" class="section level3">
<h3>Results</h3>
<pre class="r"><code>dass_fit1 |&gt; summary()</code></pre>
<pre><code>## 
## Re-fitting to get Hessian</code></pre>
<pre><code>## Call:
## polr(formula = depression_level ~ country + gender + age + orientation + 
##     race, data = dass_fit_df)
## 
## Coefficients:
##                          Value Std. Error  t value
## countryCA              0.17607   0.073979   2.3799
## countryGB              0.20429   0.069477   2.9405
## countryID             -0.03701   0.081140  -0.4561
## countryMY             -0.18594   0.043530  -4.2716
## countryOther           0.10529   0.039054   2.6959
## countryPH              0.13180   0.088407   1.4908
## genderMale            -0.10458   0.027345  -3.8244
## genderOther            0.38262   0.097990   3.9047
## age                   -0.02532   0.001429 -17.7177
## orientationAsexual     0.22638   0.048992   4.6208
## orientationBisexual    0.40403   0.033836  11.9406
## orientationHomosexual  0.29795   0.050291   5.9245
## orientationOther       0.22051   0.038272   5.7617
## raceAsian             -0.15662   0.042257  -3.7064
## raceBlack             -0.08899   0.094209  -0.9447
## raceNative American    0.10589   0.150678   0.7027
## raceOther             -0.10281   0.043678  -2.3539
## 
## Intercepts:
##                          Value    Std. Error t value 
## Moderate or Below|Severe  -0.6896   0.0476   -14.4866
## Severe|Extremely severe    0.0067   0.0474     0.1414
## 
## Residual Deviance: 60223.12 
## AIC: 60261.12</code></pre>
<p>The estimated model can be written as: <span
class="math display">\[\begin{align*}
\text{logit}(\hat P(\text{Depression Level} \leq \text{Severe})) &amp;=
-0.69 \\
&amp;+ 0.18 \times I(\text{country} = \text{CA}) \\
&amp;+ 0.20 \times I(\text{country} = \text{GB}) \\
&amp;- 0.04 \times I(\text{country} = \text{ID}) \\
&amp;- 0.19 \times I(\text{country} = \text{MY}) \\
&amp;+ 0.13 \times I(\text{country} = \text{PH}) \\
&amp;+ 0.11 \times I(\text{country} = \text{Other}) \\
&amp;- 0.10 \times I(\text{gender} = \text{Male}) \\
&amp;+ 0.38 \times I(\text{gender} = \text{Other}) \\
&amp;- 0.03 \times \text{age} \\
&amp;+ 0.23 \times I(\text{orientation} = \text{Asexual}) \\
&amp;+ 0.40 \times I(\text{orientation} = \text{Bisexual}) \\
&amp;+ 0.30 \times I(\text{orientation} = \text{Homosexual}) \\
&amp;+ 0.22 \times I(\text{orientation} = \text{Other}) \\
&amp;- 0.16 \times I(\text{race} = \text{Asian}) \\
&amp;- 0.09 \times I(\text{race} = \text{Black}) \\
&amp;+ 0.11 \times I(\text{race} = \text{Native American}) \\
&amp;- 0.10 \times I(\text{race} = \text{Other})
\end{align*}\]</span></p>
<span class="math display">\[\begin{align*}
\text{logit}(\hat P(\text{Depression Level} \leq \text{Extremely
Severe})) &amp;= 0.01 \\
&amp;+ 0.18 \times I(\text{country} = \text{CA}) \\
&amp;+ 0.20 \times I(\text{country} = \text{GB}) \\
&amp;- 0.04 \times I(\text{country} = \text{ID}) \\
&amp;- 0.19 \times I(\text{country} = \text{MY}) \\
&amp;+ 0.13 \times I(\text{country} = \text{PH}) \\
&amp;+ 0.11 \times I(\text{country} = \text{Other}) \\
&amp;- 0.10 \times I(\text{gender} = \text{Male}) \\
&amp;+ 0.38 \times I(\text{gender} = \text{Other}) \\
&amp;- 0.03 \times \text{age} \\
&amp;+ 0.23 \times I(\text{orientation} = \text{Asexual}) \\
&amp;+ 0.40 \times I(\text{orientation} = \text{Bisexual}) \\
&amp;+ 0.30 \times I(\text{orientation} = \text{Homosexual}) \\
&amp;+ 0.22 \times I(\text{orientation} = \text{Other}) \\
&amp;- 0.16 \times I(\text{race} = \text{Asian}) \\
&amp;- 0.09 \times I(\text{race} = \text{Black}) \\
&amp;+ 0.11 \times I(\text{race} = \text{Native American}) \\
&amp;- 0.10 \times I(\text{race} = \text{Other})
\end{align*}\]</span>
<p>Calculate the odds ratio and CI for variables:</p>
<pre class="r"><code># exp(cbind(OR = coef(dass_fit1), confint(dass_fit1))) |&gt; 
#   knitr::kable()</code></pre>
<div id="receiver-operating-characteristic-curve-for-depression-level"
class="section level4">
<h4>Receiver Operating Characteristic Curve for Depression Level</h4>
<p>At this stage, we would like to draw a receiver operating
characteristic (ROC) curve for depression level to check the model
fit.</p>
<pre class="r"><code># Predicting probabilities for all classes
predicted_probs &lt;- predict(dass_fit1, type = &quot;probs&quot;)

# Extracting the response variable
response &lt;- ifelse(dass_fit_df$depression_level == &quot;Moderate or Below&quot;, 1,
                   ifelse(dass_fit_df$depression_level == &quot;Severe&quot;, 2, 3))

# Calculating ROC curves for three responses
roc_obj_1 &lt;- roc(as.numeric(response == 1), predicted_probs[, &quot;Moderate or Below&quot;])
roc_obj_2 &lt;- roc(as.numeric(response == 2), predicted_probs[, &quot;Severe&quot;])
roc_obj_3 &lt;- roc(as.numeric(response == 3), predicted_probs[, &quot;Extremely severe&quot;])

# Plotting ROC curves for three responses on the same graph
plot(roc_obj_1, col = &quot;blue&quot;, main = &quot;ROC Curves for Three Responses&quot;)
plot(roc_obj_2, col = &quot;red&quot;, add = TRUE)
plot(roc_obj_3, col = &quot;green&quot;, add = TRUE)
legend(&quot;bottomright&quot;,
       legend = c(&quot;Moderate or Below&quot;, &quot;Severe&quot;, &quot;Extremely Severe&quot;),
       col = c(&quot;blue&quot;, &quot;red&quot;, &quot;green&quot;), lty = 1)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Looking at the ROC curves, it is clear that both the “Moderate or
Below” and “Extremely Severe” categories show good performance and are
close to the upper left corner, indicating effective performance in
discriminating between these categories. However, the performance of the
“Severe” category suggests an available but less significant trend
compared to the above two categories. The positioning of this curve
indicates room for improvement, implying a need for more data points
representing individuals with a “severe” level of depression. Expanding
the data set to include additional instances characterized by a “Severe”
level of depression could improve the model’s ability to discriminate
and accurately predict within this specific category.</p>
</div>
</div>
<div id="interpretation" class="section level3">
<h3>Interpretation</h3>
<div id="continuous-variable" class="section level4">
<h4>Continuous Variable</h4>
<div id="age-1" class="section level5">
<h5>Age</h5>
<ul>
<li>For every one unit increase in participant’s age, the odds of having
a more severe depression level is multiplied 0.98 times, holding
constant all other variables. It indicates that older people may have
less risk to get depressed.</li>
</ul>
</div>
</div>
<div id="categorical-variables" class="section level4">
<h4>Categorical Variables</h4>
<div id="country" class="section level5">
<h5>Country</h5>
<pre class="r"><code># Extract coefficients for countries
pos_country = str_starts(names(dass_fit1$coefficients), &quot;country&quot;)

country_coefficients =
  tibble(
    country = substr(names(dass_fit1$coefficients)[pos_country], 8, 20),
    OR = exp(dass_fit1$coefficients[pos_country])
  ) |&gt; 
  mutate(country = fct_reorder(country, OR))
  

# Plotting coefficients for countries
ggplot(country_coefficients, aes(x = country, y = OR - 1)) +
  geom_bar(stat = &quot;identity&quot;, fill = &quot;skyblue&quot;, color = &quot;black&quot;) +
  labs(title = &quot;Effect of Countries on Depression Levels&quot;,
       x = &quot;Country&quot;, y = &quot;OR - 1&quot;)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<ul>
<li>For Canadian, Britain, and Philippines participants, the odds of
having a more severe depression level is higher than that of US
participants, holding constant all other variables.</li>
<li>For Indonesia and Malaysia participants, the odds of having a more
severe depression level is lower than that of US participants, holding
constant all other variables.</li>
</ul>
</div>
<div id="gender-1" class="section level5">
<h5>Gender</h5>
<pre class="r"><code># Extract coefficients for Gender
pos_gender = str_starts(names(dass_fit1$coefficients), &quot;gender&quot;)

gender_coefficients =
  tibble(
    gender = substr(names(dass_fit1$coefficients)[pos_gender], 7, 20),
    OR = exp(dass_fit1$coefficients[pos_gender])
  ) |&gt; 
  mutate(gender = fct_reorder(gender, OR))

# Plotting coefficients for Gender
ggplot(gender_coefficients, aes(x = gender, y = OR - 1)) +
  geom_bar(stat = &quot;identity&quot;, fill = &quot;#d8b4e2&quot;, color = &quot;black&quot;) +
  labs(title = &quot;Effect of Gender on Depression Levels&quot;,
       x = &quot;Gender&quot;, y = &quot;OR - 1&quot;)</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<ul>
<li>For male participants, the odds of having a more severe depression
level is 0.90 times that of female participants, holding constant all
other variables.</li>
<li>For non-binary participants, the odds of having a more severe
depression level is 1.47 times that of female participants, holding
constant all other variables.</li>
</ul>
</div>
<div id="race-1" class="section level5">
<h5>Race</h5>
<pre class="r"><code># Extract coefficients for races
pos_race &lt;- str_starts(names(dass_fit1$coefficients), &quot;race&quot;)

race_coefficients =
  tibble(
    race = substr(names(dass_fit1$coefficients)[pos_race], 5, 20),
    OR = dass_fit1$coefficients[pos_race]
  ) |&gt; 
  mutate(race = fct_reorder(race, OR))

# Plotting coefficients for races
ggplot(race_coefficients, aes(x = race, y = OR - 1)) +
  geom_bar(stat = &quot;identity&quot;, fill = &quot;pink&quot;, color = &quot;black&quot;) +
  labs(
    title = &quot;Effect of Races on Depression Levels&quot;,
    x = &quot;Race&quot;,
    y = &quot;OR - 1&quot;
  )</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<ul>
<li>For Native American, Asian, Black, and Other participants, the odds
of having a more severe depression level is lower than that of White
participants, holding constant all other variables.</li>
</ul>
</div>
<div id="orientation-1" class="section level5">
<h5>Orientation</h5>
<pre class="r"><code># Extract coefficients for orientations
pos_orientation &lt;- str_starts(names(dass_fit1$coefficients), &quot;orientation&quot;)

orientation_coefficients &lt;- data.frame(
  orientation = substr(names(dass_fit1$coefficients)[pos_orientation], 12, 20),
  OR = exp(dass_fit1$coefficients[pos_orientation])
)

# Plotting coefficients for orientations
ggplot(orientation_coefficients, aes(x = orientation, y = OR - 1)) +
  geom_bar(stat = &quot;identity&quot;, fill = &quot;palegreen&quot;, color = &quot;black&quot;) +
  labs(
    title = &quot;Effect of Orientations on Depression Levels&quot;,
    x = &quot;Orientation&quot;,
    y = &quot;OR - 1&quot;
  )</code></pre>
<p><img src="report_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<ul>
<li>For sexual minorities, the odds of having a more severe depression
level is higher than that of heterosexual orientation participants,
holding constant all other variables.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="discussion" class="section level2">
<h2><em>Discussion</em></h2>
<div id="conclusion" class="section level3">
<h3>Conclusion</h3>
<p>In our project, we first cleaned and tidied the dataset based on
code.txt and DASS-42-scoring.pdf.</p>
<p>After exploratory analysis, we found out age, gender, orientation and
race may contribute to the depression level most. We also realized a
shiny app to show the distribution of responses for each depression
level around the world.</p>
<p>We conducted chi-square tests for age, gender, orientation and race.
Based on all p-values&lt;0.05, we could conclude that at 0.05
significance level, the null hypothesis are rejected and these factors
are all associated with depression level.</p>
<p>From the regression, we concluded that country, gender, orientation,
age and race played important roles in the model. Specifically, we found
out older people and male may have less risk to get depressed. Also,
people live in Indonesia and Malaysia have less chance to severely
depressed while in Canada, UK and Phillipines have more chance compared
to US. The results also showed that white people and sexual minorities
would be more likely to have more severe depression level. The p-value
for our model is 0.067, which greater than 0.05, indicating a
success.</p>
</div>
<div id="challenge" class="section level3">
<h3>Challenge</h3>
<p>The challenge we met was that there were some missing or meaningless
values in our raw dataset. Missing values for some variables were not
just an “N/A” and we needed to dig into the dataset to find out the true
expression of missing for each variables. Meaningless data means there
were possibilities that the responses were randomly answered by someone
or without carefulness. Thus, these observations would not be
representative then we should omit.</p>
<p>Another challenge we thought was that there were too much variables
in the raw data, we needed to figure out the parts for our project. For
example, we didn’t need information of accuracy checking remain in the
final dataset so we needed to delete these columns.</p>
</div>
<div id="limitation-and-future-improvements" class="section level3">
<h3>Limitation and Future Improvements</h3>
<ul>
<li>The observations with missing values may affect the model but we
deleted.</li>
<li>Imbalance within samples (e.g. 76.3% female samples).</li>
<li>Strong dependence between independent variables (e.g. race versus
religion).</li>
<li>Counter-intuitive results (e.g. Asian people have lower risk of
getting severely depressed than white people).</li>
<li>Future Improvements:
<ul>
<li>Try methods to impute the missing values instead of ignoring.</li>
<li>Clustering to decrease dependence;</li>
<li>Fit a separate model for each depression level to avoid parallel
assumption.</li>
</ul></li>
</ul>
</div>
</div>
<div id="reference" class="section level2">
<h2><em>Reference</em></h2>
<p>[1] Melissa et. al, doi: 10.1016/j.chiabu.2017.03.016</p>
<p>[2] Virginia et. al, doi: 10.1016/j.wombi.2020.12.014</p>
<p>[3] Postmes et. al, <a href="https://doi.org/10.1002/ejsp.2508"
class="uri">https://doi.org/10.1002/ejsp.2508</a></p>
<p>[4] Data source: <a
href="https://www.kaggle.com/datasets/lucasgreenwell/depression-anxiety-stress-scales-responses"
class="uri">https://www.kaggle.com/datasets/lucasgreenwell/depression-anxiety-stress-scales-responses</a></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
