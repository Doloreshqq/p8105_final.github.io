<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Huanyu Chen, Shaolei Ma" />

<meta name="date" content="2023-12-04" />

<title>Logistic Model</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="data.html">Data</a>
</li>
<li>
  <a href="eda.html">Exploratory Data Analysis</a>
</li>
<li>
  <a href="logit_models.html">Statistical Analysis</a>
</li>
<li>
  <a href="https://doloreshqq.shinyapps.io/r_shiny_for_p8105/">Shiny App</a>
</li>
<li>
  <a href="report.html">Report</a>
</li>
<li>
  <a href="mailto:&lt;qh2284@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/Doloreshqq/p8105_final.github.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Logistic Model</h1>
<h4 class="author">Huanyu Chen, Shaolei Ma</h4>
<h4 class="date">2023-12-04</h4>

</div>


<p>The goal is to fit an ordered logit model.</p>
<div id="independent-variables" class="section level2">
<h2>Independent Variables</h2>
<p>First, test the distribution of independent variables.</p>
<pre class="r"><code>dass_new = read_csv(&quot;data/dass_new.csv&quot;)

dass_new |&gt; 
  dplyr::select(age, everything()) |&gt; 
  mutate(across(country:depression_level, factor)) |&gt; 
  summary()</code></pre>
<pre><code>##       age           country                      education          urban      
##  Min.   :13.00   MY     :16932   Graduate degree      : 3981   Rural   : 6295  
##  1st Qu.:19.00   US     : 5989   High school          :11374   Suburban:10283  
##  Median :21.00   GB     :  891   Less than high school: 2997   Urban   :13731  
##  Mean   :23.45   CA     :  752   University degree    :11957                   
##  3rd Qu.:25.00   ID     :  746                                                 
##  Max.   :99.00   PH     :  581                                                 
##                  (Other): 4418                                                 
##     gender                      religion           orientation   
##  Female:23137   Muslim              :17204   Asexual     : 1649  
##  Male  : 6754   Atheist             : 2943   Bisexual    : 3921  
##  Other :  418   Agnostic            : 2406   Heterosexual:20259  
##                 Christian (Catholic): 2359   Homosexual  : 1548  
##                 Christian (Other)   : 1699   Other       : 2932  
##                 Other               : 1343                       
##                 (Other)             : 2355                       
##                     race                     married     
##  Arab                 :  228   Currently married : 3331  
##  Asian                :18041   Never married     :26207  
##  Black                :  432   Previously married:  771  
##  Indigenous Australian:   12                             
##  Native American      :  159                             
##  Other                : 3621                             
##  White                : 7816                             
##          depression_level
##  Extremely severe:10176  
##  Mild            : 2921  
##  Moderate        : 5433  
##  Normal          : 6832  
##  Severe          : 4947  
##                          
## </code></pre>
<p>Some categories contain few samples. For the efficacy of the model,
we regroup the independent variables following the standards below:</p>
<ul>
<li><code>country</code>: Group the country with less than 500 samples
into “Other”, and set “US” to be the reference level.</li>
<li><code>education</code>: Order the variable by the length of
education.</li>
<li><code>race</code>: We follow <a
href="https://www.govinfo.gov/content/pkg/FR-1997-10-30/pdf/97-28653.pdf">standards
on race and ethnicity</a> to include only “Asian”, “Black”, “Native
American”, “White”, and make other categories “Other”. We set “White” to
be the reference level.</li>
<li><code>religion</code>: We conclude “Christian (Catholic)”,
“Christian (Mormon)”, “Christian (Other)”, “Christian (Protestant)” into
“Christian”, and set it as the reference level.</li>
<li><code>orientation</code>: Set the “Heterosexual” to be the reference
level.</li>
<li><code>married</code>: Order the variable by marriage status.</li>
</ul>
<pre class="r"><code>dass_fit_df =
  dass_new |&gt; 
  mutate(
    country = relevel(as.factor(ifelse(country %in% c(&quot;MY&quot;, &quot;US&quot;, &quot;GB&quot;, &quot;CA&quot;, &quot;ID&quot;, &quot;PH&quot;), country, &quot;Other&quot;)), ref = &quot;US&quot;),
    education = factor(education, levels = c(&quot;Less than high school&quot;, &quot;High school&quot;, &quot;University degree&quot;, &quot;Graduate degree&quot;)),
    race = relevel(as.factor(ifelse(race %in% c(&quot;Arab&quot;, &quot;Indigenous Australian&quot;), &quot;Other&quot;, race)), ref = &quot;White&quot;),
    religion = relevel(as.factor(ifelse(substr(religion, 1, 9) == &quot;Christian&quot;, &quot;Christian&quot;, religion)), &quot;Christian&quot;),
    orientation = relevel(as.factor(orientation), &quot;Heterosexual&quot;),
    married = factor(married, levels = c(&quot;Never married&quot;, &quot;Currently married&quot;, &quot;Previously married&quot;)),
    depression_level = factor(depression_level, levels = c(&quot;Normal&quot;, &quot;Mild&quot;, &quot;Moderate&quot;, &quot;Severe&quot;, &quot;Extremely severe&quot;))
  )

dass_fit_df |&gt; summary()</code></pre>
<pre><code>##   country                      education        urban          
##  US   : 5989   Less than high school: 2997   Length:30309      
##  CA   :  752   High school          :11374   Class :character  
##  GB   :  891   University degree    :11957   Mode  :character  
##  ID   :  746   Graduate degree      : 3981                     
##  MY   :16932                                                   
##  Other: 4418                                                   
##  PH   :  581                                                   
##     gender               age             religion           orientation   
##  Length:30309       Min.   :13.00   Muslim   :17204   Heterosexual:20259  
##  Class :character   1st Qu.:19.00   Christian: 5318   Asexual     : 1649  
##  Mode  :character   Median :21.00   Atheist  : 2943   Bisexual    : 3921  
##                     Mean   :23.45   Agnostic : 2406   Homosexual  : 1548  
##                     3rd Qu.:25.00   Other    : 1343   Other       : 2932  
##                     Max.   :99.00   Hindu    :  531                       
##                                     (Other)  :  564                       
##               race                     married              depression_level
##  White          : 7816   Never married     :26207   Normal          : 6832  
##  Asian          :18041   Currently married : 3331   Mild            : 2921  
##  Black          :  432   Previously married:  771   Moderate        : 5433  
##  Native American:  159                              Severe          : 4947  
##  Other          : 3861                              Extremely severe:10176  
##                                                                             
## </code></pre>
</div>
<div id="model-fitting" class="section level2">
<h2>Model Fitting</h2>
<p>First fit a model without variables selection.</p>
<pre class="r"><code>dass_fit = 
  dass_fit_df |&gt; 
  polr(depression_level ~ ., data = _)

(fit_s = 
  dass_fit |&gt; 
  summary())</code></pre>
<pre><code>## Call:
## polr(formula = depression_level ~ ., data = dass_fit_df)
## 
## Coefficients:
##                                Value Std. Error  t value
## countryCA                   0.148517   0.071130   2.0880
## countryGB                   0.171354   0.067062   2.5552
## countryID                   0.043053   0.079163   0.5439
## countryMY                  -0.008007   0.050543  -0.1584
## countryOther                0.102717   0.039048   2.6305
## countryPH                   0.264462   0.087392   3.0262
## educationHigh school       -0.150185   0.040509  -3.7075
## educationUniversity degree -0.376834   0.044291  -8.5082
## educationGraduate degree   -0.530279   0.052303 -10.1386
## urbanSuburban              -0.027283   0.029139  -0.9363
## urbanUrban                  0.046331   0.027761   1.6689
## genderMale                 -0.166471   0.025998  -6.4032
## genderOther                 0.339713   0.096112   3.5346
## age                        -0.007523   0.001868  -4.0267
## religionAgnostic            0.187629   0.046183   4.0627
## religionAtheist             0.260434   0.044725   5.8230
## religionBuddhist           -0.210089   0.095058  -2.2101
## religionHindu               0.099165   0.087998   1.1269
## religionJewish             -0.044442   0.184671  -0.2407
## religionMuslim              0.019758   0.045019   0.4389
## religionOther               0.193342   0.056459   3.4245
## religionSikh                0.036949   0.272258   0.1357
## orientationAsexual          0.173086   0.046812   3.6975
## orientationBisexual         0.374809   0.032818  11.4208
## orientationHomosexual       0.286605   0.048017   5.9688
## orientationOther            0.195966   0.036306   5.3976
## raceAsian                  -0.091787   0.044414  -2.0666
## raceBlack                  -0.101452   0.091268  -1.1116
## raceNative American         0.136167   0.146638   0.9286
## raceOther                  -0.063766   0.044043  -1.4478
## marriedCurrently married   -0.528618   0.040748 -12.9730
## marriedPreviously married   0.041553   0.075500   0.5504
## 
## Intercepts:
##                         Value    Std. Error t value 
## Normal|Mild              -1.6935   0.0604   -28.0233
## Mild|Moderate            -1.1882   0.0600   -19.8029
## Moderate|Severe          -0.4097   0.0597    -6.8678
## Severe|Extremely severe   0.2936   0.0597     4.9209
## 
## Residual Deviance: 91341.20 
## AIC: 91413.20</code></pre>
<p>Test the parallel assumption.</p>
<pre class="r"><code>car::poTest(dass_fit)</code></pre>
<pre><code>## 
## Tests for Proportional Odds
## polr(formula = depression_level ~ ., data = dass_fit_df)
## 
##                              b[polr] b[&gt;Normal]  b[&gt;Mild] b[&gt;Moderate]
## Overall                                                               
## countryCA                   1.49e-01   1.82e-01  1.54e-01     1.64e-01
## countryGB                   1.71e-01   2.21e-01  1.44e-01     1.46e-01
## countryID                   4.31e-02   1.63e-01  1.53e-02     4.50e-02
## countryMY                  -8.01e-03   1.10e-01 -9.42e-03    -2.97e-02
## countryOther                1.03e-01   9.00e-02  6.84e-02     1.29e-01
## countryPH                   2.64e-01   3.82e-01  3.76e-01     2.69e-01
## educationHigh school       -1.50e-01  -1.31e-01 -1.25e-01    -1.47e-01
## educationUniversity degree -3.77e-01  -3.64e-01 -3.57e-01    -3.86e-01
## educationGraduate degree   -5.30e-01  -5.59e-01 -5.32e-01    -5.07e-01
## urbanSuburban              -2.73e-02   1.83e-02  3.45e-02    -2.71e-02
## urbanUrban                  4.63e-02   7.74e-02  8.22e-02     4.57e-02
## genderMale                 -1.66e-01  -2.18e-01 -1.89e-01    -1.45e-01
## genderOther                 3.40e-01   6.00e-01  5.24e-01     3.05e-01
## age                        -7.52e-03  -1.18e-02 -1.06e-02    -8.09e-03
## religionAgnostic            1.88e-01   1.34e-01  1.90e-01     2.27e-01
## religionAtheist             2.60e-01   1.76e-01  2.38e-01     2.37e-01
## religionBuddhist           -2.10e-01  -3.18e-01 -1.88e-01    -2.02e-01
## religionHindu               9.92e-02   9.13e-02  3.07e-02     1.28e-01
## religionJewish             -4.44e-02  -1.28e-02 -1.91e-01     3.51e-02
## religionMuslim              1.98e-02   2.02e-02  8.06e-02     3.27e-02
## religionOther               1.93e-01   1.82e-01  1.80e-01     2.04e-01
## religionSikh                3.69e-02   1.24e-01  2.65e-01     6.49e-02
## orientationAsexual          1.73e-01   8.23e-02  1.37e-01     2.17e-01
## orientationBisexual         3.75e-01   4.36e-01  4.06e-01     3.67e-01
## orientationHomosexual       2.87e-01   3.52e-01  2.97e-01     2.59e-01
## orientationOther            1.96e-01   2.10e-01  1.87e-01     2.07e-01
## raceAsian                  -9.18e-02  -1.97e-01 -1.54e-01    -7.88e-02
## raceBlack                  -1.01e-01  -3.18e-01 -1.74e-01    -3.18e-02
## raceNative American         1.36e-01   2.45e-01  2.22e-01     2.19e-01
## raceOther                  -6.38e-02  -1.77e-01 -1.33e-01    -3.46e-02
## marriedCurrently married   -5.29e-01  -4.77e-01 -4.85e-01    -5.13e-01
## marriedPreviously married   4.16e-02   4.13e-02  5.71e-02     1.10e-01
##                            b[&gt;Severe] Chisquare df Pr(&gt;Chisq)    
## Overall                                  168.29 96    7.3e-06 ***
## countryCA                    1.14e-01      0.84  3      0.839    
## countryGB                    1.77e-01      1.80  3      0.615    
## countryID                    1.26e-02      4.70  3      0.195    
## countryMY                   -5.16e-02      8.85  3      0.031 *  
## countryOther                 1.05e-01      3.32  3      0.345    
## countryPH                    1.76e-01      3.33  3      0.344    
## educationHigh school        -1.86e-01      1.68  3      0.641    
## educationUniversity degree  -4.25e-01      1.64  3      0.650    
## educationGraduate degree    -5.42e-01      1.15  3      0.766    
## urbanSuburban               -8.24e-02     10.81  3      0.013 *  
## urbanUrban                   4.01e-03      5.40  3      0.145    
## genderMale                  -1.50e-01      5.67  3      0.129    
## genderOther                  2.99e-01      4.14  3      0.247    
## age                         -2.29e-04     30.13  3    1.3e-06 ***
## religionAgnostic             1.90e-01      3.47  3      0.325    
## religionAtheist              2.99e-01      5.55  3      0.136    
## religionBuddhist            -1.16e-01      4.70  3      0.195    
## religionHindu                1.20e-01      2.20  3      0.532    
## religionJewish              -3.46e-02      3.08  3      0.379    
## religionMuslim              -2.39e-02      5.67  3      0.129    
## religionOther                2.04e-01      0.20  3      0.978    
## religionSikh                -7.04e-02      1.22  3      0.748    
## orientationAsexual           2.06e-01      5.93  3      0.115    
## orientationBisexual          3.62e-01      2.64  3      0.450    
## orientationHomosexual        2.66e-01      2.27  3      0.519    
## orientationOther             1.85e-01      1.13  3      0.770    
## raceAsian                   -1.59e-02      8.57  3      0.036 *  
## raceBlack                   -1.11e-02      8.62  3      0.035 *  
## raceNative American          5.56e-02      1.39  3      0.709    
## raceOther                    1.15e-04      9.10  3      0.028 *  
## marriedCurrently married    -6.06e-01      6.76  3      0.080 .  
## marriedPreviously married   -8.04e-02      8.10  3      0.044 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Because the overall <span class="math inline">\(p-value &lt;
0.001\)</span>, we reject the null hypothesis and conclude that the
parallel assumption is not met.</p>
<p>To meet the parallel assumption, we try the following two
methods:</p>
<ul>
<li><strong>Select independent variables</strong>: Because we think
<code>religion</code> and <code>race</code>, <code>married</code> and
<code>orientation</code>, <code>country</code> and <code>urban</code>
are strongly correlated with each other, and we care more about
<code>race</code>, <code>orientation</code>, and <code>country</code>,
first delete <code>religion</code>, <code>married</code>, and
<code>urban</code>. We also delete <code>education</code> to meet the
parallel assumption.</li>
<li><strong>Regroup dependent variable</strong>: Regroup
<code>depression_level</code> into “Moderate or Below”, “Severe”,
“Extremely severe”.</li>
</ul>
<pre class="r"><code>dass_fit_df =
  dass_fit_df |&gt; 
  mutate(depression_level = factor(case_match(
    depression_level,
    &quot;Normal&quot; ~ &quot;Moderate or Below&quot;,
    &quot;Mild&quot; ~ &quot;Moderate or Below&quot;,&quot;Moderate&quot; ~ &quot;Moderate or Below&quot;,
    &quot;Severe&quot; ~ &quot;Severe&quot;,
    &quot;Extremely severe&quot; ~ &quot;Extremely severe&quot;
   ), level = c(&quot;Moderate or Below&quot;, &quot;Severe&quot;, &quot;Extremely severe&quot;)))

dass_fit1 =
  dass_fit_df |&gt; 
  polr(depression_level ~ country + gender + age + orientation + race, data = _)

dass_fit1 |&gt; poTest()</code></pre>
<pre><code>## 
## Tests for Proportional Odds
## polr(formula = depression_level ~ country + gender + age + orientation + 
##     race, data = dass_fit_df)
## 
##                        b[polr] b[&gt;Moderate or Below] b[&gt;Severe] Chisquare df
## Overall                                                             26.43 17
## countryCA              0.17607               0.19690    0.15297      0.50  1
## countryGB              0.20429               0.19144    0.22882      0.46  1
## countryID             -0.03701              -0.01653   -0.06773      0.57  1
## countryMY             -0.18594              -0.16470   -0.22038      2.40  1
## countryOther           0.10529               0.11040    0.09276      0.30  1
## countryPH              0.13180               0.16664    0.09162      1.01  1
## genderMale            -0.10458              -0.10721   -0.10290      0.04  1
## genderOther            0.38262               0.38336    0.38755      0.00  1
## age                   -0.02532              -0.02674   -0.02206     17.25  1
## orientationAsexual     0.22638               0.23486    0.22828      0.03  1
## orientationBisexual    0.40403               0.40507    0.40757      0.01  1
## orientationHomosexual  0.29795               0.28623    0.30345      0.17  1
## orientationOther       0.22051               0.23073    0.21375      0.27  1
## raceAsian             -0.15662              -0.17315   -0.13328      1.31  1
## raceBlack             -0.08899              -0.07969   -0.07401      0.01  1
## raceNative American    0.10589               0.19327    0.02714      1.40  1
## raceOther             -0.10281              -0.11014   -0.09253      0.24  1
##                       Pr(&gt;Chisq)    
## Overall                    0.067 .  
## countryCA                  0.480    
## countryGB                  0.496    
## countryID                  0.451    
## countryMY                  0.121    
## countryOther               0.584    
## countryPH                  0.316    
## genderMale                 0.850    
## genderOther                0.960    
## age                      3.3e-05 ***
## orientationAsexual         0.873    
## orientationBisexual        0.929    
## orientationHomosexual      0.678    
## orientationOther           0.601    
## raceAsian                  0.252    
## raceBlack                  0.942    
## raceNative American        0.236    
## raceOther                  0.627    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The model meets the parallel assumption at <span
class="math inline">\(\alpha=0.05\)</span> level (with an overall <span
class="math inline">\(p = 0.067 &gt; 0.05\)</span>).</p>
<pre class="r"><code>dass_fit1 |&gt; summary()</code></pre>
<pre><code>## Call:
## polr(formula = depression_level ~ country + gender + age + orientation + 
##     race, data = dass_fit_df)
## 
## Coefficients:
##                          Value Std. Error  t value
## countryCA              0.17607   0.073979   2.3799
## countryGB              0.20429   0.069477   2.9405
## countryID             -0.03701   0.081140  -0.4561
## countryMY             -0.18594   0.043530  -4.2716
## countryOther           0.10529   0.039054   2.6959
## countryPH              0.13180   0.088407   1.4908
## genderMale            -0.10458   0.027345  -3.8244
## genderOther            0.38262   0.097990   3.9047
## age                   -0.02532   0.001429 -17.7177
## orientationAsexual     0.22638   0.048992   4.6208
## orientationBisexual    0.40403   0.033836  11.9406
## orientationHomosexual  0.29795   0.050291   5.9245
## orientationOther       0.22051   0.038272   5.7617
## raceAsian             -0.15662   0.042257  -3.7064
## raceBlack             -0.08899   0.094209  -0.9447
## raceNative American    0.10589   0.150678   0.7027
## raceOther             -0.10281   0.043678  -2.3539
## 
## Intercepts:
##                          Value    Std. Error t value 
## Moderate or Below|Severe  -0.6896   0.0476   -14.4866
## Severe|Extremely severe    0.0067   0.0474     0.1414
## 
## Residual Deviance: 60223.12 
## AIC: 60261.12</code></pre>
<p>The estimated model can be written as: <span
class="math display">\[\begin{align*}
\text{logit}(\hat P(\text{Depression Level} \leq \text{Severe})) &amp;=
-0.69 \\
&amp;+ 0.18 \times I(\text{country} = \text{CA}) \\
&amp;+ 0.20 \times I(\text{country} = \text{GB}) \\
&amp;- 0.04 \times I(\text{country} = \text{ID}) \\
&amp;- 0.19 \times I(\text{country} = \text{MY}) \\
&amp;+ 0.13 \times I(\text{country} = \text{PH}) \\
&amp;+ 0.11 \times I(\text{country} = \text{Other}) \\
&amp;- 0.10 \times I(\text{gender} = \text{Male}) \\
&amp;+ 0.38 \times I(\text{gender} = \text{Other}) \\
&amp;- 0.03 \times \text{age} \\
&amp;+ 0.23 \times I(\text{orientation} = \text{Asexual}) \\
&amp;+ 0.40 \times I(\text{orientation} = \text{Bisexual}) \\
&amp;+ 0.30 \times I(\text{orientation} = \text{Homosexual}) \\
&amp;+ 0.22 \times I(\text{orientation} = \text{Other}) \\
&amp;- 0.16 \times I(\text{race} = \text{Asian}) \\
&amp;- 0.09 \times I(\text{race} = \text{Black}) \\
&amp;+ 0.11 \times I(\text{race} = \text{Native American}) \\
&amp;- 0.10 \times I(\text{race} = \text{Other})
\end{align*}\]</span></p>
<p><span class="math display">\[\begin{align*}
\text{logit}(\hat P(\text{Depression Level} \leq \text{Extremely
Severe})) &amp;= 0.01 \\
&amp;+ 0.18 \times I(\text{country} = \text{CA}) \\
&amp;+ 0.20 \times I(\text{country} = \text{GB}) \\
&amp;- 0.04 \times I(\text{country} = \text{ID}) \\
&amp;- 0.19 \times I(\text{country} = \text{MY}) \\
&amp;+ 0.13 \times I(\text{country} = \text{PH}) \\
&amp;+ 0.11 \times I(\text{country} = \text{Other}) \\
&amp;- 0.10 \times I(\text{gender} = \text{Male}) \\
&amp;+ 0.38 \times I(\text{gender} = \text{Other}) \\
&amp;- 0.03 \times \text{age} \\
&amp;+ 0.23 \times I(\text{orientation} = \text{Asexual}) \\
&amp;+ 0.40 \times I(\text{orientation} = \text{Bisexual}) \\
&amp;+ 0.30 \times I(\text{orientation} = \text{Homosexual}) \\
&amp;+ 0.22 \times I(\text{orientation} = \text{Other}) \\
&amp;- 0.16 \times I(\text{race} = \text{Asian}) \\
&amp;- 0.09 \times I(\text{race} = \text{Black}) \\
&amp;+ 0.11 \times I(\text{race} = \text{Native American}) \\
&amp;- 0.10 \times I(\text{race} = \text{Other})
\end{align*}\]</span></p>
</div>
<div id="effect-of-countries-on-depression-levels"
class="section level2">
<h2>Effect of Countries on Depression Levels</h2>
<pre class="r"><code># Extract coefficients for countries
pos_country = str_starts(names(dass_fit1$coefficients), &quot;country&quot;)

country_coefficients &lt;- data.frame(
  country = substr(names(dass_fit1$coefficients)[pos_country], 8, 20),
  coefficient = dass_fit1$coefficients[pos_country]
  )

# Plotting coefficients for countries
ggplot(country_coefficients, aes(x = country, y = coefficient)) +
  geom_bar(stat = &quot;identity&quot;, fill = &quot;skyblue&quot;, color = &quot;black&quot;) +
  labs(title = &quot;Effect of Countries on Depression Levels&quot;,
       x = &quot;Country&quot;, y = &quot;Coefficient&quot;)</code></pre>
<p><img src="logit_models_files/figure-html/unnamed-chunk-7-1.png" width="90%" /></p>
</div>
<div id="effect-of-races-on-depression-levels" class="section level2">
<h2>Effect of Races on Depression Levels</h2>
<pre class="r"><code># Extract coefficients for races
pos_race &lt;- str_starts(names(dass_fit1$coefficients), &quot;race&quot;)

race_coefficients &lt;- data.frame(
  race = substr(names(dass_fit1$coefficients)[pos_race], 5, 20),
  coefficient = dass_fit1$coefficients[pos_race]
)

# Plotting coefficients for races
ggplot(race_coefficients, aes(x = race, y = coefficient)) +
  geom_bar(stat = &quot;identity&quot;, fill = &quot;pink&quot;, color = &quot;black&quot;) +
  labs(
    title = &quot;Effect of Races on Depression Levels&quot;,
    x = &quot;Race&quot;,
    y = &quot;Coefficient&quot;
  )</code></pre>
<p><img src="logit_models_files/figure-html/unnamed-chunk-8-1.png" width="90%" /></p>
</div>
<div id="effect-of-orientations-on-depression-levels"
class="section level2">
<h2>Effect of Orientations on Depression Levels</h2>
<pre class="r"><code># Extract coefficients for orientations
pos_orientation &lt;- str_starts(names(dass_fit1$coefficients), &quot;orientation&quot;)

orientation_coefficients &lt;- data.frame(
  orientation = substr(names(dass_fit1$coefficients)[pos_orientation], 12, 20),
  coefficient = dass_fit1$coefficients[pos_orientation]
)

# Plotting coefficients for orientations
ggplot(orientation_coefficients, aes(x = orientation, y = coefficient)) +
  geom_bar(stat = &quot;identity&quot;, fill = &quot;palegreen&quot;, color = &quot;black&quot;) +
  labs(
    title = &quot;Effect of Orientations on Depression Levels&quot;,
    x = &quot;Orientation&quot;,
    y = &quot;Coefficient&quot;
  )</code></pre>
<p><img src="logit_models_files/figure-html/unnamed-chunk-9-1.png" width="90%" /></p>
</div>
<div id="interpretation" class="section level2">
<h2>Interpretation</h2>
<p>Calculate the odds ratio and CI for variables:</p>
<pre class="r"><code>exp(cbind(OR = coef(dass_fit1), confint(dass_fit1))) |&gt; 
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">OR</th>
<th align="right">2.5 %</th>
<th align="right">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">countryCA</td>
<td align="right">1.1925157</td>
<td align="right">1.0318245</td>
<td align="right">1.3782103</td>
</tr>
<tr class="even">
<td align="left">countryGB</td>
<td align="right">1.2266600</td>
<td align="right">1.0704578</td>
<td align="right">1.4055722</td>
</tr>
<tr class="odd">
<td align="left">countryID</td>
<td align="right">0.9636663</td>
<td align="right">0.8218074</td>
<td align="right">1.1293962</td>
</tr>
<tr class="even">
<td align="left">countryMY</td>
<td align="right">0.8303232</td>
<td align="right">0.7624447</td>
<td align="right">0.9043076</td>
</tr>
<tr class="odd">
<td align="left">countryOther</td>
<td align="right">1.1110279</td>
<td align="right">1.0292477</td>
<td align="right">1.1993359</td>
</tr>
<tr class="even">
<td align="left">countryPH</td>
<td align="right">1.1408746</td>
<td align="right">0.9592119</td>
<td align="right">1.3566382</td>
</tr>
<tr class="odd">
<td align="left">genderMale</td>
<td align="right">0.9007041</td>
<td align="right">0.8536665</td>
<td align="right">0.9502554</td>
</tr>
<tr class="even">
<td align="left">genderOther</td>
<td align="right">1.4661200</td>
<td align="right">1.2111017</td>
<td align="right">1.7784689</td>
</tr>
<tr class="odd">
<td align="left">age</td>
<td align="right">0.9750021</td>
<td align="right">0.9722673</td>
<td align="right">0.9777274</td>
</tr>
<tr class="even">
<td align="left">orientationAsexual</td>
<td align="right">1.2540564</td>
<td align="right">1.1391381</td>
<td align="right">1.3801892</td>
</tr>
<tr class="odd">
<td align="left">orientationBisexual</td>
<td align="right">1.4978457</td>
<td align="right">1.4017927</td>
<td align="right">1.6005003</td>
</tr>
<tr class="even">
<td align="left">orientationHomosexual</td>
<td align="right">1.3470905</td>
<td align="right">1.2206347</td>
<td align="right">1.4865163</td>
</tr>
<tr class="odd">
<td align="left">orientationOther</td>
<td align="right">1.2467100</td>
<td align="right">1.1566076</td>
<td align="right">1.3436678</td>
</tr>
<tr class="even">
<td align="left">raceAsian</td>
<td align="right">0.8550255</td>
<td align="right">0.7870384</td>
<td align="right">0.9288322</td>
</tr>
<tr class="odd">
<td align="left">raceBlack</td>
<td align="right">0.9148506</td>
<td align="right">0.7603206</td>
<td align="right">1.1000728</td>
</tr>
<tr class="even">
<td align="left">raceNative American</td>
<td align="right">1.1116959</td>
<td align="right">0.8274552</td>
<td align="right">1.4947023</td>
</tr>
<tr class="odd">
<td align="left">raceOther</td>
<td align="right">0.9022940</td>
<td align="right">0.8282279</td>
<td align="right">0.9829067</td>
</tr>
</tbody>
</table>
<p><strong>Country</strong>:</p>
<ul>
<li>For Canadian, Britain, and Philippines participants, the odds of
having a more severe depression level is higher than that of US
participants, holding constant all other variables.</li>
<li>For Indonesia and Malaysia participants, the odds of having a more
severe depression level is lower than that of US participants, holding
constant all other variables.</li>
</ul>
<p><strong>Gender</strong>:</p>
<ul>
<li>For male participants, the odds of having a more severe depression
level is 0.90 times that of female participants, holding constant all
other variables.</li>
<li>For non-binary participants, the odds of having a more severe
depression level is 1.47 times that of female participants, holding
constant all other variables.</li>
</ul>
<p><strong>Age</strong>:</p>
<ul>
<li>For every one unit increase in participant’s age, the odds of having
a more severe depression level is multiplied 0.98 times, holding
constant all other variables. It indicates that older people may have
less risk to get depressed.</li>
</ul>
<p><strong>Orientation</strong>:</p>
<ul>
<li>For sexual minorities, the odds of having a more severe depression
level is higher than that of heterosexual orientation participants,
holding constant all other variables.</li>
</ul>
<p><strong>Race</strong>:</p>
<ul>
<li>For Native American participants, the odds of having a more severe
depression level is higher than that of White participants, holding
constant all other variables.</li>
<li>For Asian, Black, and Other participants, the odds of having a more
severe depression level is lower than that of White participants,
holding constant all other variables.</li>
</ul>
</div>
<div id="receiver-operating-characteristic-curve-for-depression-level"
class="section level2">
<h2>Receiver Operating Characteristic Curve for Depression Level</h2>
<pre class="r"><code># Predicting probabilities for all classes
predicted_probs &lt;- predict(dass_fit1, type = &quot;probs&quot;)

# Extracting the response variable
response &lt;- ifelse(dass_fit_df$depression_level == &quot;Moderate or Below&quot;, 1,
                   ifelse(dass_fit_df$depression_level == &quot;Severe&quot;, 2, 3))

# Calculating ROC curves for three responses
roc_obj_1 &lt;- roc(as.numeric(response == 1), predicted_probs[, &quot;Moderate or Below&quot;])
roc_obj_2 &lt;- roc(as.numeric(response == 2), predicted_probs[, &quot;Severe&quot;])
roc_obj_3 &lt;- roc(as.numeric(response == 3), predicted_probs[, &quot;Extremely severe&quot;])

# Plotting ROC curves for three responses on the same graph
plot(roc_obj_1, col = &quot;blue&quot;, main = &quot;ROC Curves for Three Responses&quot;)
plot(roc_obj_2, col = &quot;red&quot;, add = TRUE)
plot(roc_obj_3, col = &quot;green&quot;, add = TRUE)
legend(&quot;bottomright&quot;,
       legend = c(&quot;Moderate or Below&quot;, &quot;Severe&quot;, &quot;Extremely Severe&quot;),
       col = c(&quot;blue&quot;, &quot;red&quot;, &quot;green&quot;), lty = 1)</code></pre>
<p><img src="logit_models_files/figure-html/unnamed-chunk-11-1.png" width="90%" />
According to this graph, the ROC curves for “Moderate or Below” and
“Extremely Severe” are close to the top-left corner of the plot, showing
a good model’s performance in these two categories. The performance on
“Severe” may indicate that we need more data points that have a
depression level of “Severe.”</p>
</div>
<div id="effects-of-predictors-on-depression-levels"
class="section level2">
<h2>Effects of Predictors on Depression Levels</h2>
<pre class="r"><code># Create a data frame with the predictor values for visualization
predictor_data &lt;- model.matrix(depression_level ~ country + gender + age
                               + orientation + race, data = dass_fit_df)

# Compute the effects
effects &lt;- allEffects(dass_fit1, xlevels = list(predictor_data))

# Plot the effects
plot(effects, style = &quot;stacked&quot;)</code></pre>
<p><img src="logit_models_files/figure-html/unnamed-chunk-12-1.png" width="90%" /></p>
</div>
<div id="limitations" class="section level2">
<h2>Limitations</h2>
<ul>
<li>Imbalance within samples (e.g. 76.3% female samples).</li>
<li>Strong dependence between independent variables (e.g. race versus
religion).</li>
<li>Counterintuitive results (e.g. Asian people have lower risk of
getting severely depressed than white people).</li>
<li>Future Improvements:
<ul>
<li>Clustering to decrease dependence;</li>
<li>Fit a separate model for each depression level to avoid parallel
assumption.</li>
</ul></li>
</ul>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
